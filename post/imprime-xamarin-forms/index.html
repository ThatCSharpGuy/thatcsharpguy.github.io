<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
<head>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href='http://thatcsharpguy.com/assets/site/favicon.png'>
  <title>¿Imprimir desde Xamarin.Forms? - That CS guy</title>
  <meta name="description" content="Imprime desde tu app hecha con Xamarin.Forms, ofrece a tus usuarios la posibilidad de generar reportes, tickets y facturas desde su teléfono celular y listas...">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://thatcsharpguy.com/post/imprime-xamarin-forms/">
  <link rel="alternate" type="application/rss+xml" title="That CS guy" href="http://thatcsharpguy.com/feed.xml" />
  <!-- Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-94016385-1', 'auto');
    ga('send', 'pageview');
  </script>


  <!-- Twitter cards  -->
	 
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://thatcsharpguy.com/postimages//xamarin-forms/print/featured.png">
	
	<meta name="twitter:site" content="@io_exception" />
	<meta name="twitter:title" content="¿Imprimir desde Xamarin.Forms?" />
	<meta name="twitter:description" content="Imprime desde tu app hecha con Xamarin.Forms, ofrece a tus usuarios la posibilidad de generar reportes, tickets y facturas desde su teléfono celular y listas..." />


    <!-- Facebook open graph tags -->  
    
    <meta property="og:image" content="http://thatcsharpguy.com/postimages//xamarin-forms/print/featured.png" />
    
    
    <meta property="og:title" content="¿Imprimir desde Xamarin.Forms?" />
    <meta property="og:site_name" content="That CS guy"/>
    <meta property="og:url" content="http://thatcsharpguy.com/post/imprime-xamarin-forms/">
    <meta property="og:description" content="Imprime desde tu app hecha con Xamarin.Forms, ofrece a tus usuarios la posibilidad de generar reportes, tickets y facturas desde su teléfono celular y listas..." />
    <meta property="article:author" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="article:publisher" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="fb:app_id" content="942345702508916" />
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/masonry/3.3.2/masonry.pkgd.min.js"></script>

</head>
  <body>

    <header class="site-header ui">
  <div class="wrapper menu">
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
        <a class="link page-link" href="/">Inicio</a>
        
        <a class="link page-link" href="/tv">TV</a>
        
        <a class="link page-link" href="/acerca-de">Acerca de</a>
        
        <a class="link page-link" href="/tag">Tags</a>
        
        <a class="link page-link" href="/busqueda">Buscar</a>
        
        <a class="link page-link" href="/suscribete">Suscríbete</a>
        
        <a class="link page-link" href="/herramientas">Herramientas</a>
        
        <a class="link page-link" href="/libros">Libros</a>
        
      </div>
    </nav>
  </div>
  <div class="wrapper title">
    <div class="pure-g">
      <div class="pure-u-1-24 title-number"><span>1</span></div>
      <div class="pure-u-13-24 content-window">
        <a class="site-title" href="/">That CS guy</a>
      </div>
      <div class="pure-u-10-24 header-menu">
        <ul>
          <li class="youtube"><a href="https://www.youtube.com/c/thatcsharpguy">YouTube</a></li>
          <li class="csharp"><a href="http://thatcsharpguy.com/tag/AprendeCSharp/">Aprende C#</a></li>
          <li class="xamarin"><a href="http://thatcsharpguy.com/tag/Xamarin/">Xamarin</a></li>
        </ul>
      </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div id="post-meta">
    <a href="/acerca-de/#citando" rel="author">Antonio Feregrino</a> | 09/05/2017
 

| <strong><a href="https://github.com/ThatCSharpGuy/formsprinting" target="_blank"><i class="sp sp-git"></i> Ver código de este post en GitHub</a></strong>

</div>
<h1 class="post-title">¿Imprimir desde Xamarin.Forms?</h1>
<div class="post-content">

    <article>
        <p>Sí, así como lo oyes. Imprimir desde una app… la verdad es que a mi me sonó un poco extraño cuando escuché este requerimiento puesto que nunca se me había ocurrido conectar una impresora directamente a un teléfono móvil. Y la verdad es que en la actualidad la necesidad de imprimir se ha visto superada por la posibilidad de enviar documentos electrónicos.</p>

<p>Pero bueno, imagina que por alguna razón tu app debe tener la capacidad de imprimir. Buscando por la red me encontré con el post <a href="https://codemilltech.com/xamarin-forms-e-z-print" target="_blank">Xamarin.Forms E-Z Print</a> en donde se habla justamente de esto. En este post trataré de explicar qué es lo que sucede.</p>

<p>Si ya has generado reportes desde cualquier otra plataforma sabes que una de las dificultades de hacerlo radica en obtener el formato que al cliente le parezca el adecuado… sí, esa suele ser una preocupación real. Y para evitar esto, usando el método de Matthew Soucoup nos vamos a auxiliar del lenguaje HTML para poder especificar el formato para nuestro documento.</p>

<h2 id="el-modelo">El modelo</h2>

<p>En esta aplicación demo (<a href="https://github.com/ThatCSharpGuy/formsprinting" target="_blank">que puedes obtener en GitHub</a>) te permite añadir productos y generar después un ticket de compra. Para ello cree dos clases <code>Orden</code> y <code>Producto</code>, a lo cual llamaremos el Modelo.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Orden</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">IdOrden</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Cliente</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Producto</span><span class="p">&gt;</span> <span class="n">Productos</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">double</span> <span class="n">Total</span> <span class="p">=&gt;</span> <span class="n">Productos</span><span class="p">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.</span><span class="n">Total</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">Producto</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Nombre</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">double</span> <span class="n">Total</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="template">Template</h2>

<p>Para comenzar, debemos añadir una <a href="https://developer.xamarin.com/guides/cross-platform/advanced/razor_html_templates/#Razor_Template_Basics" target="_blank">plantilla Razor</a> (únicamente he visto disponible esta opción en Xamarin y Visual Studio para Mac).</p>

<figure><img src="/postimages//xamarin-forms/print/razor-template-creation.png" alt="&quot;Add Razor template&quot; images_set" /></figure>

<p>Esto creará un archivo <code>.cshtml</code> el cual debemos tratar como cualquier otro archivo <code>html</code> con algunas pequeñas diferencias que a continuación veremos:</p>

<h4 id="especificando-el-modelo">Especificando el modelo</h4>

<p>Usualmente las plantillas Razor tienen asociada una clase de la cual se toman los datos para ser mostrados. En la primera (después de la declaración de los <code>using</code>) línea, se debe especificar cuál es esta clase. Esto se realiza mediante la instrucción <code>@model</code>:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="n">@model</span> <span class="n">Ticket</span></code></pre></figure>

<h4 id="es-un-documento-normal">Es un documento normal</h4>

<p>Al seguir siendo un documento <code>html</code> no olvides especificar los <em>tags</em> <em>html</em>, <em>head</em> y demás. Oh, y también nota la especificación de la etiquieta <em>link</em>, esto lo veremos más adelante:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>  
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>  
    <span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;ticket.css&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="c">&lt;!-- contenido --&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>  </code></pre></figure>

<h4 id="el-contenido">El contenido</h4>

<p>Ahora sí, vamos a crear el contenido. En este punto hay algo que debes comprender: no esperes crear complejas animaciones y efectos con CSS y que funcionen en tus documentos, para el diseño de tu plantilla vete a lo sencillo. En este caso yo usé tablas para ordenar los elementos que deseaba mostrar.</p>

<p>Para acceder a los valores del modelo vamos a hacer uso de la propiedad <code>Model</code> del template, para hacer referencia a esta propiedad debemos anteponer el símbolo <code>@</code> (nota también la etiqueta <em>img</em>):</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>		<span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;header&quot;</span><span class="nt">&gt;</span>
			<span class="nt">&lt;tr&gt;</span>
				<span class="nt">&lt;td&gt;</span>
					<span class="nt">&lt;h1&gt;</span>Ticket: @Model.IdOrden<span class="nt">&lt;/h1&gt;</span>
					<span class="nt">&lt;h3&gt;</span>Cliente: @Model.Cliente<span class="nt">&lt;/h3&gt;</span>
				<span class="nt">&lt;/td&gt;</span>
				<span class="nt">&lt;td&gt;&lt;img</span> <span class="na">src=</span><span class="s">&quot;logo.png&quot;</span> <span class="na">width=</span><span class="s">&quot;100px&quot;</span><span class="nt">&gt;&lt;/td&gt;</span>
			<span class="nt">&lt;/tr&gt;</span>
		<span class="nt">&lt;/table&gt;</span></code></pre></figure>

<p>Las plantillas Razor también permiten usar sentencias de control como <code>foreach</code> para darle forma al documento:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span>		<span class="p">&lt;</span><span class="n">table</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="n">thead</span><span class="p">&gt;</span>
				<span class="p">&lt;</span><span class="n">tr</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">Producto</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">Precio</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
				<span class="p">&lt;/</span><span class="n">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;/</span><span class="n">thead</span><span class="p">&gt;</span>
			<span class="n">@foreach</span><span class="p">(</span><span class="kt">var</span> <span class="n">prod</span> <span class="k">in</span> <span class="n">Model</span><span class="p">.</span><span class="n">Productos</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="p">&lt;</span><span class="n">tr</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">@prod</span><span class="p">.</span><span class="n">Nombre</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="p">=</span><span class="s">&quot;precio&quot;</span><span class="p">&gt;</span><span class="n">@prod</span><span class="p">.</span><span class="n">Total</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
				<span class="p">&lt;/</span><span class="n">tr</span><span class="p">&gt;</span>
			<span class="p">}</span>
			<span class="p">&lt;</span><span class="n">tfoot</span><span class="p">&gt;</span>
				<span class="p">&lt;</span><span class="n">tr</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="p">=</span><span class="s">&quot;total&quot;</span><span class="p">&gt;</span><span class="n">Total</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
					<span class="p">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="p">=</span><span class="s">&quot;precio total&quot;</span><span class="p">&gt;</span><span class="n">@Model</span><span class="p">.</span><span class="n">Total</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
				<span class="p">&lt;/</span><span class="n">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;/</span><span class="n">tfoot</span><span class="p">&gt;</span>
		<span class="p">&lt;/</span><span class="n">table</span><span class="p">&gt;</span></code></pre></figure>

<p>Hasta aquí llega la creación de la plantilla, ahora vamos a ver cómo se usa.</p>

<h2 id="usando-la-plantilla">Usando la plantilla</h2>

<p>Para hacer uso de la plantilla hay que crear in objeto de la clase asociada (en este caso es <code>TicketTemplate</code>), establecer su propiedad <code>Model</code> a una instancia del modelo que vamos a asociar con ella. Después, con el método <code>GenerateString</code> provocamos que se genere la plantilla y obtengamos una cadena de ella.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Orden</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Propiedades</span>
<span class="p">};</span>

<span class="kt">var</span> <span class="n">template</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TicketTemplate</span><span class="p">();</span>
<span class="n">template</span><span class="p">.</span><span class="n">Model</span> <span class="p">=</span> <span class="n">ticket</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">rendered</span> <span class="p">=</span> <span class="n">template</span><span class="p">.</span><span class="n">GenerateString</span><span class="p">();</span></code></pre></figure>

<p>La cadena <code>rendered</code> contiene el html de la plantilla, pero que ya contiene la información del modelo asociado. El siguiente paso es ayudarnos de la clase <code>HtmlWebViewSource</code> y del <code>WebView</code>.</p>

<p>La clase <code>HtmlWebViewSource</code> permite establecer la fuente de datos de un <code>WebView</code> a una cadena que contiene el código que debe mostrarse dentro de él, así que si quieres mostrar una previsualización de tu documento, mostrar el <code>WebView</code> es una buena idea.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">htmlSource</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HtmlWebViewSource</span><span class="p">();</span>
<span class="n">htmlSource</span><span class="p">.</span><span class="n">Html</span> <span class="p">=</span> <span class="n">rendered</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">browser</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebView</span><span class="p">();</span>
<span class="n">browser</span><span class="p">.</span><span class="n">Source</span> <span class="p">=</span> <span class="n">htmlSource</span><span class="p">;</span></code></pre></figure>

<h2 id="enviando-la-impresión">Enviando la impresión</h2>

<p>Enviar la impresión al dispositivo conectado es una tarea que es distinta para cada plataforma, es por eso que vamos a hacer uso de <a href="https://developer.xamarin.com/guides/xamarin-forms/application-fundamentals/dependency-service/introduction/" target="_blank">servicio de dependencias</a> de Xamarin para compartir código específico a cada plataforma.</p>

<p>Comenzamos por crear la interfaz <code>IPrinter</code>, que contará con un único método que recibirá el <code>WebView</code> que contiene nuestra plantilla generada:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">IPrintService</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Print</span><span class="p">(</span><span class="n">WebView</span> <span class="n">viewToPrint</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h3 id="en-ios">En iOS</h3>

<p>La implementación de iOS consiste en tomar el <code>WebView</code> que recibe y obtener el control nativo (UIWebView). De ahí, obtener una instancia de <code>PrintInfo</code>, y es aquí en donde puedes configurar la impresión: tipo de colores, impresión a dos lados, etcétera. Por último, debes obtener la instancia compartida de  <code>PrintController</code>, la cual se debe presentar al usuario.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">IosPrinter</span> <span class="p">:</span> <span class="n">IPrinter</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Print</span><span class="p">(</span><span class="n">WebView</span> <span class="n">viewToPrint</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">renderer</span> <span class="p">=</span> <span class="n">Platform</span><span class="p">.</span><span class="n">CreateRenderer</span><span class="p">(</span><span class="n">viewToPrint</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">webView</span> <span class="p">=</span> <span class="n">renderer</span><span class="p">.</span><span class="n">NativeView</span> <span class="k">as</span> <span class="n">UIWebView</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">printInfo</span> <span class="p">=</span> <span class="n">UIPrintInfo</span><span class="p">.</span><span class="n">PrintInfo</span><span class="p">;</span>
        <span class="n">printInfo</span><span class="p">.</span><span class="n">OutputType</span> <span class="p">=</span> <span class="n">UIPrintInfoOutputType</span><span class="p">.</span><span class="n">General</span><span class="p">;</span>
        <span class="n">printInfo</span><span class="p">.</span><span class="n">JobName</span> <span class="p">=</span> <span class="s">&quot;Xamarin.Forms printing&quot;</span><span class="p">;</span>
        <span class="n">printInfo</span><span class="p">.</span><span class="n">Orientation</span> <span class="p">=</span> <span class="n">UIPrintInfoOrientation</span><span class="p">.</span><span class="n">Portrait</span><span class="p">;</span>
        <span class="n">printInfo</span><span class="p">.</span><span class="n">Duplex</span> <span class="p">=</span> <span class="n">UIPrintInfoDuplex</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">printController</span> <span class="p">=</span> <span class="n">UIPrintInteractionController</span><span class="p">.</span><span class="n">SharedPrintController</span><span class="p">;</span>
        <span class="n">printController</span><span class="p">.</span><span class="n">PrintInfo</span> <span class="p">=</span> <span class="n">printInfo</span><span class="p">;</span>
        <span class="n">printController</span><span class="p">.</span><span class="n">ShowsPageRange</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">printController</span><span class="p">.</span><span class="n">PrintFormatter</span> <span class="p">=</span> <span class="n">webView</span><span class="p">.</span><span class="n">ViewPrintFormatter</span><span class="p">;</span>
        <span class="n">printController</span><span class="p">.</span><span class="n">Present</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="p">(</span><span class="n">printInteractionController</span><span class="p">,</span> <span class="n">completed</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="en-android">En Android</h3>

<p>En Android también hay que obtener la vista nativa (se llama <code>WebView</code> también, pero usé un <a href="http://thatcsharpguy.com/post/creando-propios-alias/" target="_blank">alias</a> para renombrarlo a <code>DroidWebView</code>). Luego hay que obtener un <code>PrintDocumentAdapter</code>, puedes escribir el tuyo propio para establecer las propiedades de la impresión… pero por ahora usaremos el que nos da por default el <code>WebView</code> nativo.  Después hay que obtener el servicio de <code>PrintManager</code> y finalmente solicitar la impresión.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">DroidPrinter</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Print</span><span class="p">(</span><span class="n">WebView</span> <span class="n">viewToPrint</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">renderer</span> <span class="p">=</span> <span class="n">Platform</span><span class="p">.</span><span class="n">CreateRenderer</span><span class="p">(</span><span class="n">viewToPrint</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">webView</span> <span class="p">=</span> <span class="n">renderer</span><span class="p">.</span><span class="n">ViewGroup</span><span class="p">.</span><span class="n">GetChildAt</span><span class="p">(</span><span class="m">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">DroidWebView</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">webView</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">version</span> <span class="p">=</span> <span class="n">Build</span><span class="p">.</span><span class="n">VERSION</span><span class="p">.</span><span class="n">SdkInt</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">version</span> <span class="p">&gt;=</span> <span class="n">BuildVersionCodes</span><span class="p">.</span><span class="n">Kitkat</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">documentAdapter</span> <span class="p">=</span> <span class="n">webView</span><span class="p">.</span><span class="n">CreatePrintDocumentAdapter</span><span class="p">();</span>
                <span class="kt">var</span> <span class="n">printMgr</span> <span class="p">=</span> <span class="p">(</span><span class="n">PrintManager</span><span class="p">)</span><span class="n">Forms</span><span class="p">.</span><span class="n">Context</span><span class="p">.</span><span class="n">GetSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">PrintService</span><span class="p">);</span>
                <span class="n">printMgr</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="s">&quot;Forms-EZ-Print&quot;</span><span class="p">,</span> <span class="n">documentAdapter</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="en-el-proyecto-de-forms">En el proyecto de Forms</h3>

<p>Para ejecutarlo en el proyecto de Forms basta con obtener una referencia del servicio de dependencias y llamar al método <code>Print</code>:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">printService</span> <span class="p">=</span> <span class="n">DependencyService</span><span class="p">.</span><span class="n">Get</span><span class="p">&lt;</span><span class="n">IPrinter</span><span class="p">&gt;();</span>
<span class="n">printService</span><span class="p">.</span><span class="n">Print</span><span class="p">(</span><span class="n">browser</span><span class="p">);</span></code></pre></figure>

<h2 id="para-terminar">Para terminar</h2>

<p>Si bien te va a costar un poco de trabajo lograr que la impresión salga como tu deseas, al final el resultado valdrá la pena y así harás que tu app tenga un <em>plus</em> frente a otras. Oh, y si estás buscando si esto mismo se puede hacer para Windows… pues si se puede, pero es un tanto más complicado.</p>

<p>Vuelvo a hacer referencia al <a href="https://codemilltech.com/xamarin-forms-e-z-print" target="_blank">post original</a>, en donde se expone esta idea. Así mismo te invito a descargar el <a href="https://github.com/ThatCSharpGuy/formsprinting" target="_blank">código de la app de ejemplo</a>.</p>

    </article>
    <div class="post-contact">
        <div class="pure-g">
    <div class="pure-u-1 pure-u-md-7-24">
        ¿Dudas? ¿comentarios?
        <ul class="post-contact-list">
            <li><a title="feregrino@thatcsharpguy.com" href="mailto:feregrino@thatcsharpguy.com?subject=%C2%BFImprimir+desde+Xamarin.Forms%3F"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a title="@io_exception" href="https://twitter.com/intent/tweet?text=@io_exception about %C2%BFImprimir+desde+Xamarin.Forms%3F"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            <li><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M31 31H1V1h30v30z"/><path d="M31 2.88v16.87h-5.63v7.68l-4-2.95v2.74l-9.38.02L7.86 31H4.74v-3.7H1V12.36h5.63V2.88H31z" fill="#F6F6F6"/><path d="M19.75 23.27v2.1H12.1L6.62 29v-3.63H2.88V14.13h3.75V16H4.75v7.5H8.5v2.03l2.8-2.03h6.57v-1.62l1.88 1.4z" fill="#424242"/><path d="M17.88 6.63h9.37V16h-5.63v4.09l-3.54-3.55-.55-.55h-7.17V6.62h7.5zM8.5 4.75v13.13h8.26l6.74 5.57v-5.57h5.63V4.74H8.5z" fill="#424242"/><path d="M25.38 10.38H12.24V8.5h13.13v1.88zM21.63 14.13h-9.38v-1.88h9.38v1.88z" fill="#424242"/><path d="M8.5 25.53V23.5" fill="#F6F6F6"/><g fill="#F0EFF1"><path d="M17.88 21.88v1.62H11.3l-2.8 2.03V23.5H4.75V16h1.88v3.75h8.36l2.88 2.13zM17.88 6.63h-7.5V16h7.15l.55.55 3.55 3.54V16h5.62V6.62h-9.38zm3.75 7.5h-9.38v-1.88h9.38v1.88zm3.75-3.76H12.24V8.5h13.13v1.88z"/></g></g></svg> <a id="post-count" href="http://thatcsharpguy.com/post/imprime-xamarin-forms/#disqus_thread" data-disqus-identifier="/post/imprime-xamarin-forms/"></a></li>
        </ul>
    </div>  
    <div class="pure-u-1 pure-u-md-10-24">
        
            
        
    </div>
    <div class="pure-u-1 pure-u-md-7-24">
        Comparte esto
        <ul class="post-contact-list">
            <li><a href="mailto:?subject=¿Imprimir desde Xamarin.Forms?&amp;body=http://thatcsharpguy.com/post/imprime-xamarin-forms/" title="email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a href="https://twitter.com/intent/tweet?text=%C2%BFImprimir+desde+Xamarin.Forms%3F http://thatcsharpguy.com/post/imprime-xamarin-forms/&hashtags=XamarinForms" title="Tweet"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            
            <li><a href="javascript:sharePostFacebook();" title="share" ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg></a> </li>
            <li><a class="kindleWidget" href="#" title="send to kindle"> <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 32 32">
  <path fill-rule="evenodd" d="M1 3c0-1.1.9-2 2-2h26c1.1 0 2 .9 2 2v26c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3zm8.4-.3V29h3.2v-8.72h.07L19.54 29h3.8l-8.07-10.06 7.34-7.5h-3.7l-6.2 6.36h-.08V2.7H9.4z"/>
</svg> </a> </li>
        </ul>
    </div>
</div>
<script>
    function sharePostFacebook() {
        FB.ui({
  method: 'share',
  href: 'http://thatcsharpguy.com/post/imprime-xamarin-forms/',
}, function(response){});
    }
</script>
<script type="text/javascript" src="https://d1xnn692s7u6t6.cloudfront.net/widget.js"></script>
<script type="text/javascript">(function k(){window.$SendToKindle&&window.$SendToKindle.Widget?$SendToKindle.Widget.init({}):setTimeout(k,500);})();</script>
    </div>
</div>


<div id="disqus_thread"></div>
<script id="dsq-count-scr" src="//thatcharpguy.disqus.com/count.js" async></script>
<script>
    var noCommentsText = "deja un comentario";
    var commentText = " comentario";
    
//var disqus_developer = 1; // this would set it to developer mode

    var disqus_config = function () {
        this.page.url = "http://thatcsharpguy.com/post/imprime-xamarin-forms/"; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = "/post/imprime-xamarin-forms/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.title ="¿Imprimir desde Xamarin.Forms?";
    };
</script>
<script src="/js/comments.js"></script>

      </div>
    </div>

    <footer class="site-footer ui">
  <div class="wrapper pure-g">
      <div class="pure-u-1 pure-u-md-8-24">
          <div class="footer-content">
              <ul class="icon-list">
    <li id="em">
        <a href="mailto:feregrino@thatcsharpguy.com" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg>
        </a>
    </li>
    <li id="gh">
        <a href="https://github.com/ThatCSharpGuy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 16.37q0 4.9-2.86 8.8-2.86 3.93-7.4 5.43-.52.1-.77-.13-.24-.24-.24-.6v-4.1q0-1.9-1.02-2.78 1.2-.2 2.1-.4.9-.3 1.87-.8.95-.5 1.58-1.3.65-.8 1.05-2.1.4-1.27.4-2.93 0-2.38-1.54-4.04.7-1.78-.16-3.98-.57-.2-1.6.2t-1.8.85l-.75.47q-1.83-.5-3.76-.5t-3.76.5l-.8-.54Q11 8.16 9.9 7.7q-1.13-.4-1.7-.23-.86 2.2-.14 3.97-1.54 1.68-1.54 4.05 0 1.6.4 2.9.4 1.23 1.02 2.02.63.8 1.58 1.3.94.53 1.83.77.9.25 2 .37-.77.7-.94 2-.4.2-.82.3-.47.1-1.1.1-.66 0-1.3-.44-.63-.4-1.08-1.2-.38-.63-.95-1-.52-.4-.9-.5l-.4-.03q-.4 0-.57.1-.15.1-.1.24.06.13.18.26t.26.2l.15.1q.44.2.86.73t.63 1l.2.43q.23.75.84 1.2.6.47 1.3.6.7.13 1.34.14.65 0 1.08-.04l.46-.08v2.74q0 .35-.26.6-.25.22-.8.12-4.5-1.5-7.37-5.42-3-3.74-3-8.64 0-4.1 2-7.54 2-3.44 5.45-5.46 3.45-2 7.53-2t7.6 2q3.4 2 5.4 5.46 2 3.44 2 7.53z"/></svg>
        </a>
    </li>
    <li id="yt">
        <a href="https://www.youtube.com/c/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M22.43 15.714c0-.413-.17-.714-.504-.904l-8.57-5.357c-.347-.223-.71-.234-1.09-.033-.368.2-.552.513-.552.937V21.07c0 .426.184.738.553.94.178.088.35.133.52.133.222 0 .412-.056.568-.168l8.57-5.357c.336-.19.504-.49.504-.904zm8.57 0c0 1.072-.006 1.91-.017 2.51-.01.604-.058 1.366-.142 2.287-.083.92-.208 1.744-.376 2.47-.178.815-.563 1.5-1.155 2.06-.592.557-1.284.88-2.077.97-2.477.28-6.222.42-11.233.42-5.01 0-8.756-.14-11.233-.42-.793-.09-1.487-.413-2.085-.97-.597-.56-.984-1.245-1.163-2.06-.157-.726-.277-1.55-.36-2.47-.085-.92-.132-1.682-.143-2.285-.01-.602-.017-1.44-.017-2.51 0-1.072.006-1.91.017-2.512.01-.603.058-1.364.142-2.285.083-.92.208-1.744.376-2.47.178-.814.563-1.5 1.155-2.058.592-.56 1.284-.882 2.077-.97C7.244 5.14 10.99 5 16 5c5.01 0 8.756.14 11.233.42.793.088 1.487.41 2.085.97.597.558.984 1.244 1.163 2.06.157.724.277 1.547.36 2.468.085.92.132 1.682.143 2.285.01.603.017 1.44.017 2.51z"/></svg>
        </a>
    </li>
    <li id="tw">
        <a href="https://twitter.com/io_exception" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg>
        </a>
    </li>    
    <li id="fb">
        <a href="https://www.facebook.com/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg>
        </a>
    </li>
    <li id="gp">
        <a href="https://www.google.com/+Thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.9 14.25h-2.7v-2.72h-2.73v2.72h-2.7v2.72h2.7v2.7h2.72v-2.7h2.7v-2.72M10.5 17.5h5.4c-.22 1.4-1.64 4.12-5.4 4.12-3.25 0-5.9-2.7-5.9-6 0-3.33 2.65-6.02 5.9-6.02 1.85 0 3.08.78 3.8 1.46l2.58-2.48c-1.66-1.55-3.8-2.5-6.38-2.5C5.26 6.1 1 10.35 1 15.62s4.26 9.52 9.52 9.52c5.5 0 9.14-3.86 9.14-9.3 0-.62-.07-1.1-.15-1.57h-8.96"/></svg>
        </a>
    </li>
</ul>
<ul class="icon-list">
    <li>
        <a href="/acerca-de">
            <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M7 18.89v-5.88H1.15v-6H7V1.1h6v5.91h6V1.1h6v5.91h5.85v6H25v5.88h5.85v6H25v5.912h-6v-5.91h-6v5.91H7v-5.91H1.15v-6H7zm6 0v-5.88h6v5.88h-6z" fill="#3C8A3F" fill-rule="evenodd"/></svg>
        </a>
    </li>
</ul>
          </div>
      </div>
      <div class="pure-u-1 pure-u-md-6-24">
      </div>
      <div class="pure-u-1 pure-u-md-10-24">
          <div class="footer-content">
              <div class="panel active" id="footer-signup">
    <div class="panel-title">
        <span class="title">Suscríbete</span>
    </div>
    <div class="panel-content">
    Recibe semanalmente lo nuevo en That C# guy
    <form class="pure-form-stacked" action="//thatcsharpguy.us11.list-manage.com/subscribe/post?u=ebfe25f4824d7335380cf1ffd&amp;id=eca72e1174" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
                
                <input type="email" value="" placeholder="dirección de email" name="EMAIL" class="required email" id="mce-EMAIL">
                
                <button type="submit" name="subscribe" id="mc-embedded-subscribe" class="button">
                    <span style="text-decoration:underline;">E</span>nviar
                </button>
                <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true">
                    <input type="text" name="b_ebfe25f4824d7335380cf1ffd_eca72e1174" tabindex="-1" value="">
                </div>
    </form>
    </div>
</div>
          </div>
      </div>
  </div>
</footer>
   
  </body>

</html>
