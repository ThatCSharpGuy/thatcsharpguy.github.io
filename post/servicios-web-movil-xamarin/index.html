<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
<head>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href='http://thatcsharpguy.com/assets/site/favicon.png'>
  <title>Servicios web resistentes en aplicaciones móviles - That C# guy</title>
  <meta name="description" content="Llevamos nuestros dispositivos con nosotros a donde sea. Los tenemos en casa, en el trabajo y durante las vacaciones. Están con nosotros sin importar si esta...">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://thatcsharpguy.com/post/servicios-web-movil-xamarin/">
  <link rel="alternate" type="application/rss+xml" title="That C# guy" href="http://thatcsharpguy.com/feed.xml" />
  <!-- Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-94016385-1', 'auto');
    ga('send', 'pageview');
  </script>


  <!-- Twitter cards  -->
	 
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://thatcsharpguy.com/postimages//xamarin-forms/resilient/featured.jpg">
	
	<meta name="twitter:site" content="@io_exception" />
	<meta name="twitter:title" content="Servicios web resistentes en aplicaciones móviles" />
	<meta name="twitter:description" content="Llevamos nuestros dispositivos con nosotros a donde sea. Los tenemos en casa, en el trabajo y durante las vacaciones. Están con nosotros sin importar si esta..." />


    <!-- Facebook open graph tags -->  
    
    <meta property="og:image" content="http://thatcsharpguy.com/postimages//xamarin-forms/resilient/featured.jpg" />
    
    
    <meta property="og:title" content="Servicios web resistentes en aplicaciones móviles" />
    <meta property="og:site_name" content="That C# guy"/>
    <meta property="og:url" content="http://thatcsharpguy.com/post/servicios-web-movil-xamarin/">
    <meta property="og:description" content="Llevamos nuestros dispositivos con nosotros a donde sea. Los tenemos en casa, en el trabajo y durante las vacaciones. Están con nosotros sin importar si esta..." />
    <meta property="article:author" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="article:publisher" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="fb:app_id" content="942345702508916" />
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/masonry/3.3.2/masonry.pkgd.min.js"></script>

</head>
  <body>

    <header class="site-header ui">
  <div class="wrapper menu">
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
        <a class="link page-link" href="/">Inicio</a>
        
        <a class="link page-link" href="/tv">TV</a>
        
        <a class="link page-link" href="/acerca-de">Acerca de</a>
        
        <a class="link page-link" href="/tag">Tags</a>
        
        <a class="link page-link" href="/busqueda">Buscar</a>
        
        <a class="link page-link" href="/suscribete">Suscríbete</a>
        
        <a class="link page-link" href="/herramientas">Herramientas</a>
        
        <a class="link page-link" href="/libros">Libros</a>
        
      </div>
    </nav>
  </div>
  <div class="wrapper title">
    <div class="pure-g">
      <div class="pure-u-1-24 title-number"><span>1</span></div>
      <div class="pure-u-13-24 content-window">
        <a class="site-title" href="/">That C# guy</a>
      </div>
      <div class="pure-u-10-24 header-menu">
        <ul>
          <li class="youtube"><a href="https://www.youtube.com/c/thatcsharpguy">YouTube</a></li>
          <li class="csharp"><a href="http://thatcsharpguy.com/tag/AprendeCSharp/">Aprende C#</a></li>
          <li class="xamarin"><a href="http://thatcsharpguy.com/tag/Xamarin/">Xamarin</a></li>
        </ul>
      </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div id="post-meta">
    <a href="/acerca-de/#citando" rel="author">Antonio Feregrino</a> | 15/08/2016
 

| <strong><a href="https://github.com/ThatCSharpGuy/Akavache-sample" target="_blank"><i class="sp sp-git"></i> Ver código de este post en GitHub</a></strong>

</div>
<h1 class="post-title">Servicios web resistentes en aplicaciones móviles</h1>
<div class="post-content">

    <article>
        <blockquote>
  <p>Este es post es una traducción del post de <a href="https://twitter.com/RobGibbens" target="_blank">Rob Gibbens</a> llamado <a href="http://arteksoftware.com/resilient-network-services-with-xamarin/" target="_blank">Resilient network services with mobile Xamarin apps</a>, te invito a visitar el post y el resto de su blog.</p>
</blockquote>

<p>Durante mucha de la historia de la computación, nuestras computadoras y nuestras aplicaciones estuvieron en computadoras y no se movían. Nosotros contábamos con una fuente constante de energía, recursos y acceso a la red. Los desarrolladores no necesitaban pasar mucho tiempo previendo interrupciones o fallas con esos recursos. Inclusive era común tener aplicaciones que funcionaban localmente, en las que ni siquiera teníamos que pensar en la red.</p>

<h2 id="vivimos-en-un-mundo-móvil">Vivimos en un mundo móvil</h2>
<p>Llevamos nuestros dispositivos con nosotros a donde sea. Los tenemos en casa, en el trabajo y durante las vacaciones. Están con nosotros sin importar si estamos conectados a internet wifi de 1 gigabit o en una red 4g. Tienen que funcionar mientras viajamos en túneles, trenes, automóviles, volando a 9000 metros de altura y cuando no tenemos conexión. Como desarrolladores debemos, no solo esperar esos requisitos, sino tomarlos en cuenta desde el desarrollo inicial y la arquitectura de nuestra aplicación móvil.</p>

<h2 id="enfoque-actual">Enfoque actual</h2>
<p>Cuando empezamos a escribir nuestras apps con Xamarin, probablemente optamos por el enfoque sencillo de escribir el código que se conecta con la red nosotros mismos. Tal vez solamente usamos la librería <em>HttpClient</em> de Microsoft para hacer una llamada, y después <em>Json.net</em> para deserializar el resultado. O puede que nos luzcamos e incluyamos algunas otras librerías también. Puedes ver este enfoque en el post de Rob <a href="http://arteksoftware.com/end-to-end-mvvm-with-xamarin/">End to End Mvvm with Xamarin</a> en donde muestra la implementación de un cliente para un servicio.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">namespace</span> <span class="nn">DtoToVM.Services</span>  
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Net.Http.Headers</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">AutoMapper</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">DtoToVM.Dtos</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">DtoToVM.Models</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">TekConfClient</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Conference</span><span class="p">&gt;&gt;</span> <span class="n">GetConferences</span> <span class="p">()</span>
        <span class="p">{</span>
            <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;</span> <span class="n">conferenceDtos</span> <span class="p">=</span> <span class="n">Enumerable</span><span class="p">.</span><span class="n">Empty</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;();</span>
            <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Conference</span><span class="p">&gt;</span> <span class="n">conferences</span> <span class="p">=</span> <span class="n">Enumerable</span><span class="p">.</span><span class="n">Empty</span><span class="p">&lt;</span><span class="n">Conference</span><span class="p">&gt;</span> <span class="p">();</span>

            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">httpClient</span> <span class="p">=</span> <span class="n">CreateClient</span> <span class="p">())</span> <span class="p">{</span>
                <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">httpClient</span><span class="p">.</span><span class="n">GetAsync</span> <span class="p">(</span><span class="s">&quot;conferences&quot;</span><span class="p">).</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">IsSuccessStatusCode</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">ReadAsStringAsync</span> <span class="p">().</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrWhiteSpace</span> <span class="p">(</span><span class="n">json</span><span class="p">))</span> <span class="p">{</span>
                        <span class="n">conferenceDtos</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span> <span class="p">(()</span> <span class="p">=&gt;</span> 
                            <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;&gt;(</span><span class="n">json</span><span class="p">)</span>
                        <span class="p">).</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

                        <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="n">Run</span><span class="p">(()</span> <span class="p">=&gt;</span> 
                            <span class="n">Mapper</span><span class="p">.</span><span class="n">Map</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Conference</span><span class="p">&gt;&gt;</span> <span class="p">(</span><span class="n">conferenceDtos</span><span class="p">)</span>
                        <span class="p">).</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">conferences</span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ApiBaseAddress</span> <span class="p">=</span> <span class="s">&quot;http://api.tekconf.com/v1/&quot;</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">HttpClient</span> <span class="nf">CreateClient</span> <span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">httpClient</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span> 
            <span class="p">{</span> 
                <span class="n">BaseAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">ApiBaseAddress</span><span class="p">)</span>
            <span class="p">};</span>

            <span class="n">httpClient</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
            <span class="n">httpClient</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="n">Accept</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">MediaTypeWithQualityHeaderValue</span><span class="p">(</span><span class="s">&quot;application/json&quot;</span><span class="p">));</span>

            <span class="k">return</span> <span class="n">httpClient</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Este código funciona, pero no toma en cuenta ningún error en la red. Si la red estuviera caída, el servicio no respondiera u ocurriera alguna excepción, nuestra aplicación se cerraría. Evidentemente, esto no es lo óptimo.</p>

<h2 id="objetivos">Objetivos</h2>
<p>Los objetivos de nuestras apps deben incluir, pero no limitarse, a los siguientes:</p>

<ul>
  <li>Acceso sencillo a servicios <em>restful</em></li>
  <li>Rápida respuesta para nuestros usuarios</li>
  <li>Funcionar <em>offline</em></li>
  <li>Manejo de errores</li>
</ul>

<p>Como objetivos secundarios:</p>

<ul>
  <li>Desarrollo en poco tiempo</li>
  <li>Facilidad de mantenimiento</li>
  <li>Reusar librerías existentes</li>
</ul>

<p>Ataquemos estos objetivos uno a la vez, y veremos cómo podemos mejorar nuestra aplicación conectada. Como casi siempre, estaré usando una la app de una conferencia basada en TekConf.</p>

<blockquote>
  <p>El código de ejemplo está disponible en <a href="https://github.com/RobGibbens/ResilientServices">el GitHub de Rob</a></p>
</blockquote>

<h2 id="acceso-fácil-a-servicios-restful">Acceso fácil a servicios <em>restful</em></h2>

<h3 id="refit">Refit</h3>

<figure class="console"><pre><code>PM&gt; Install-Package Refit</code></pre></figure>

<p>La primera cosa que vamos a necesitar es una forma para acceder a nuestros servicios. <strong>Podríamos</strong> usar HttpClient + Json.net como hicimos en el ejemplo anterior, sin embargo, podemos hacer esto más simple. De nuevo, uno de nuestros objetivos secundarios es reusar librerías existentes. La primera que usaremos es <a href="https://github.com/paulcbetts/refit" target="_blank" rel="nofollow">Refit</a>. Refit nos permite definir una interfaz que describe la API que estamos llamando, y el framework se encarga de hacer la llamada al servicio y deserializar el objeto de regreso.</p>

<p>En nuestro caso, la interfaz se verá más así:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="na">[Headers(&quot;Accept: application/json&quot;)]</span>
<span class="k">public</span> <span class="k">interface</span> <span class="n">ITekConfApi</span>  
<span class="p">{</span>
<span class="na">    [Get(&quot;/conferences&quot;)]</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;&gt;</span> <span class="n">GetConferences</span><span class="p">();</span>

<span class="na">    [Get(&quot;/conferences/{slug}&quot;)]</span>
    <span class="n">Task</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;</span> <span class="n">GetConference</span><span class="p">(</span><span class="kt">string</span> <span class="n">slug</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>Aquí estamos declarando que nuestra API retornará <em>json</em>, y que hay dos “métodos” (recursos) que podemos llamar. El primer método es una petición HTTP GET al <em>endpoint</em> <code>/conferencias</code>. El segundo método es también una petición HTTP GET, y pasa un argumento como parte de la url para obtener una sola conferencia.</p>

<p>Una vez que la interfaz ha sido definida, usarla es tan simple como esta:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">tekconfApi</span> <span class="p">=</span> <span class="n">RestService</span><span class="p">.</span><span class="n">For</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(</span><span class="s">&quot;http://api.tekconf.com/v1&quot;</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">tekconfApi</span><span class="p">.</span><span class="n">GetConferences</span><span class="p">();</span>

<span class="kt">var</span> <span class="n">codemash</span> <span class="p">=</span> <span class="k">await</span> <span class="n">tekconfApi</span><span class="p">.</span><span class="n">GetConference</span><span class="p">(</span><span class="s">&quot;codemash-2016&quot;</span><span class="p">);</span>  </code></pre></figure>

<h2 id="fast-response-for-our-users">Fast response for our users</h2>

<h3 id="akavache">Akavache</h3>

<figure class="console"><pre><code>PM&gt; Install-Package Akavache</code></pre></figure>

<p>Ahora que tenemos una forma sencilla de acceder al servicio, nos podemos concentrar en la experiencia de usuario. El desempeño de una aplicación móvil, desde la perspectiva del usuario, es <strong>crítica</strong>. No importa en realidad si tu aplicación <strong>ES</strong> rápida mientras que el usuario <strong>PIENSE</strong> que lo es.</p>

<p>La mejor manera de acelerar una llamada a un servicio es no hacer esa llamada en primer lugar. Cargar la información almacenada localmente es exponencialmente más rápido que hacer una petición web, especialmente cuando estamos en un dispositivo móvil conectado en una red celular lenta. Aquí, podemos usar la técnica común de cachear los datos. Cuando la página termine de cargar y solicite datos para mostrar, nosotros inmediatamente queremos la información cacheada en nuestro dispositivo y mostrarla. Desde la perspectiva del usuario, la página se muestra inmediatamente. Mientras esto ocurre, nosotros consultamos al servicio remoto, obtenemos la nueva información y la almacenamos en cache. Dado que el usuario no necesita esperar a que la consulta al servicio concluya, podemos ejecutarla a nuestra discreción y conseguirnos un poco más de tiempo para procesarla.</p>

<p>Mientras que pudimos haber escrito toda la lógica de cacheo nosotros mismos, en su lugar agregamos un paquete de NuGet llamado <a href="https://github.com/akavache/Akavache" target="_blank" rel="nofollow">Akavache</a>. Del sitio de Akavache:</p>

<blockquote>
  <p>Akavache es un repositorio de <em>clave-valor</em> asíncrono y persistente (i. e. escribe a disco) creado para escribir aplicaciones de escritorio y móviles en C#, basado en SQLite3. Akavache es ideal para almacenar tanto información importante (i. e. configuración de usuarios) así como información local que debe expirar.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">ConferenceDto</span><span class="p">&gt;&gt;</span> <span class="n">GetConferences</span><span class="p">()</span>  
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="n">BlobCache</span><span class="p">.</span><span class="n">LocalMachine</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">cachedConferences</span> <span class="p">=</span> <span class="n">cache</span><span class="p">.</span><span class="n">GetAndFetchLatest</span><span class="p">(</span><span class="s">&quot;conferences&quot;</span><span class="p">,</span> <span class="n">GetRemoteConferencesAsync</span><span class="p">,</span>
        <span class="n">offset</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">elapsed</span> <span class="p">=</span> <span class="n">DateTimeOffset</span><span class="p">.</span><span class="n">Now</span> <span class="p">-</span> <span class="n">offset</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">elapsed</span> <span class="p">&gt;</span> <span class="k">new</span> <span class="n">TimeSpan</span><span class="p">(</span><span class="n">hours</span><span class="p">:</span> <span class="m">0</span><span class="p">,</span> <span class="n">minutes</span><span class="p">:</span> <span class="m">30</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="m">0</span><span class="p">);</span>
        <span class="p">});</span>

    <span class="kt">var</span> <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">cachedConferences</span><span class="p">.</span><span class="n">FirstOrDefaultAsync</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">conferences</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>Podemos usar el método <code>GetAndFetchLatest</code> de Akavache para devolver inmediatamente las conferencias almacenadas, si hay alguna. Al mismo tiempo, preparamos una petición a nuestro método <code>GetRemoteConferencesAsync</code>, quién hará la llamada al servicio remoto si el periodo de tiempo indicado ha transcurrido.</p>

<p>Matthew Soucop tiene un muy buen <a href="http://codemilltech.com/akavache-is-aka-awesome/" target="_blank" rel="nofollow">post de Akavache</a>.</p>

<h3 id="modernhttpclient">ModernHttpClient</h3>

<figure class="console"><pre><code>PM&gt; Install-Package ModernHttpClient</code></pre></figure>

<p>A pesar de que nos gustaría siempre obtener los datos de la cache, sabemos que en algún momento tendremos que llamar al servicio remoto. Sin embargo, en la <em>Xamarin stack</em>, nos encontramos con un problema, por default Mono (y por tanto Xamarin) usa la <em>Mono networking stack</em>. Funciona, pero Apple y Google hay pasado un montón de tiempo optimizando su <em>stack</em> de redes en sus respectivas plataformas, y cando usamos <code>HttpClient</code> estamos pasando par algo dichas optimizaciones por completo. Podemos arreglar esto añadiendo <a href="https://github.com/paulcbetts/ModernHttpClient" target="_blank" rel="nofollow">ModernHttpClient</a>.</p>

<blockquote>
  <p>Esta librería lleva las librerías de red más recientes a Xamarin a través de un tipo <code>HttpClient</code> modificado. Escribe tu aplicación usando <code>System.Net.Http</code> pero coloca esta librería e irá drásticamente más rápido.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">(</span><span class="k">new</span> <span class="n">NativeMessageHandler</span><span class="p">())</span>  
<span class="p">{</span>
    <span class="n">BaseAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">apiBaseAddress</span><span class="p">)</span>
<span class="p">};</span>

<span class="k">return</span> <span class="n">RestService</span><span class="p">.</span><span class="n">For</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(</span><span class="n">client</span><span class="p">);</span></code></pre></figure>

<p>Al pasar <code>NativeMessageHandler</code> al constructir de <code>HttpClient</code>, automáticamente estamos usando el <em>stack</em> apropiado en cada plataforma.</p>

<h3 id="fusillade">Fusillade</h3>

<figure class="console"><pre><code>PM&gt; Install-Package Fusillade</code></pre></figure>

<p>Desde la perspectiva del usuario, no todas las peticiones al servicio son iguales. Peticiones que son iniciadas por una acción del usuario deben tener una prioridad que cualquier otra que la app haga por su cuenta. Recuerda que nuestro objetivo es que el usuario <strong>sienta</strong> que la app responde rápido.</p>

<p><a href="https://github.com/paulcbetts/Fusillade" target="_blank" rel="nofollow">Fusillade</a> es otro paquete de NuGetque vamos a usar para contar con:</p>

<ul>
  <li>Evitar duplicar peticiones automáticas</li>
  <li>Limitar peticiones</li>
  <li>Priorizar peticiones</li>
  <li>Contar con peticiones especulativas</li>
</ul>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ApiService</span> <span class="p">:</span> <span class="n">IApiService</span>  
<span class="p">{</span>
    <span class="k">public</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">ApiBaseAddress</span> <span class="p">=</span> <span class="s">&quot;http://api.tekconf.com/v1&quot;</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">ApiService</span><span class="p">(</span><span class="kt">string</span> <span class="n">apiBaseAddress</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Func</span><span class="p">&lt;</span><span class="n">HttpMessageHandler</span><span class="p">,</span> <span class="n">ITekConfApi</span><span class="p">&gt;</span> <span class="n">createClient</span> <span class="p">=</span> <span class="n">messageHandler</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HttpClient</span><span class="p">(</span><span class="n">messageHandler</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">BaseAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">apiBaseAddress</span> <span class="p">??</span> <span class="n">ApiBaseAddress</span><span class="p">)</span>
            <span class="p">};</span>

            <span class="k">return</span> <span class="n">RestService</span><span class="p">.</span><span class="n">For</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(</span><span class="n">client</span><span class="p">);</span>
        <span class="p">};</span>

        <span class="n">_background</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">createClient</span><span class="p">(</span>
            <span class="k">new</span> <span class="nf">RateLimitedHttpMessageHandler</span><span class="p">(</span><span class="k">new</span> <span class="n">NativeMessageHandler</span><span class="p">(),</span> <span class="n">Priority</span><span class="p">.</span><span class="n">Background</span><span class="p">)));</span>

        <span class="n">_userInitiated</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">createClient</span><span class="p">(</span>
            <span class="k">new</span> <span class="nf">RateLimitedHttpMessageHandler</span><span class="p">(</span><span class="k">new</span> <span class="n">NativeMessageHandler</span><span class="p">(),</span> <span class="n">Priority</span><span class="p">.</span><span class="n">UserInitiated</span><span class="p">)));</span>

        <span class="n">_speculative</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="n">createClient</span><span class="p">(</span>
            <span class="k">new</span> <span class="nf">RateLimitedHttpMessageHandler</span><span class="p">(</span><span class="k">new</span> <span class="n">NativeMessageHandler</span><span class="p">(),</span> <span class="n">Priority</span><span class="p">.</span><span class="n">Speculative</span><span class="p">)));</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;</span> <span class="n">_background</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;</span> <span class="n">_userInitiated</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">Lazy</span><span class="p">&lt;</span><span class="n">ITekConfApi</span><span class="p">&gt;</span> <span class="n">_speculative</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">ITekConfApi</span> <span class="n">Background</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_background</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">ITekConfApi</span> <span class="n">UserInitiated</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_userInitiated</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">ITekConfApi</span> <span class="n">Speculative</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_speculative</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Ahora, en lugar de solamente usar <code>HttpClient</code>, tenemos una clase <code>ApiService</code> que tendrá tres instancias de <code>Refit</code>, para peticiones iniciadas por el usuario (<em>UserInitiated</em>), en segundo plano (<em>Background</em>) y especulativas (<em>Speculative</em>).</p>

<p>Cuando la página carga por primera vez, nosotros automáticamente trataremos de obtener información sobre las conferencias. Dado que el usuario no inició esta petición, podemos enviar esta petición a segundo plano.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_conferencesService</span>  
                        <span class="p">.</span><span class="n">GetConferences</span><span class="p">(</span><span class="n">Priority</span><span class="p">.</span><span class="n">Background</span><span class="p">)</span>
                        <span class="p">.</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span></code></pre></figure>

<p>Si el usuario selecciona el botón de actualizar, entonces tendríamos que correr esta petición con diferente prioridad.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_conferencesService</span>  
                        <span class="p">.</span><span class="n">GetConferences</span><span class="p">(</span><span class="n">Priority</span><span class="p">.</span><span class="n">UserInitiated</span><span class="p">)</span>
                        <span class="p">.</span><span class="n">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span></code></pre></figure>

<p>Cuando las conferencias <em>regresan</em> del servicio, podríamos asumir que el usuario seleccionará una de ellas para ver sus detalles. Puesto que solo estamos especulando que esto podría ocurrir, podemos preparar una petición para obtener los detalles de las conferencias con prioridad especulativa:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">slug</span> <span class="k">in</span> <span class="n">conferences</span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Slug</span><span class="p">))</span>  
<span class="p">{</span>
    <span class="n">_conferencesService</span><span class="p">.</span><span class="n">GetConference</span><span class="p">(</span><span class="n">Priority</span><span class="p">.</span><span class="n">Speculative</span><span class="p">,</span> <span class="n">slug</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<blockquote>
  <p>Una nota de Paul Betts: “Si usas la prioridad especulativa, tienes que llamar a ResetLimit en tu app móvil para reestablecer el límite de descarga de 5MB cada que navegues entre páginas (esta no es una regla estricta, pero es una buena idea - básicamente cuando sepas que el usuario está “iniciando una nueva sesión”). La prioridad especulativa es definitivamente algo que la mayoría de apps no necesitan - imagínate una app de Reddit en donde intentes descargar cada elemento en la página, pero en realidad no quieres hacer eso, tal vez solo intentes adivinar qué es lo que el usuario quiere ver. Entonces el desarrollador puede ser flojo y decir “Descarga todo, <em>yolo</em>” y Fusillade las eliminará basándose en el contenido de cada una.</p>
</blockquote>

<p>## Funcionamiento <em>offline</em></p>

<p>Contrario a las aplicaciones de escritorio, nuestras aplicaciones móviles deben ser alguna funcionalidad mientras están desconectadas de la red. La peor cosa que podríamos hacer es que falle cuando tratamos de hacer una petición. Lo mejor que podríamos hacer es que siga funcionando para que el usuario no se de cuenta de que no estaba conectado a internet.</p>

<h3 id="connectivity">Connectivity</h3>

<figure class="console"><pre><code>PM&gt; Install-Package Xam.Plugin.Connectivity</code></pre></figure>

<p>Si queremos estar seguros de que no causaremos un excepción al hacer una petición cuando no hay internet, entonces necesitamos una manera de conocer el estado de la conexión. Cada plataforma tiene su manera de hacer esta validación, pero nosotros queremos hacer uso de ella de una manera <em>cross-platform</em> desde nuestra PCL.</p>

<p><a href="https://github.com/jamesmontemagno/Xamarin.Plugins/tree/master/Connectivity" target="_blank" rel="nofollow">Connectivity</a> es un plugin para Xamarin que nos permite hacer justamente eso.</p>

<blockquote>
  <p>Simple plugin multiplataforma para revisar el estado de la conexión en un dispositivo móvil, obtener el tipo de conexión, el ancho de banda y más.</p>
</blockquote>

<p>Antes de hacer una petición de red, podemos revisar si el dispositivo está conectado.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="k">if</span> <span class="p">(</span><span class="n">CrossConnectivity</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">IsConnected</span><span class="p">)</span>  
<span class="p">{</span>
    <span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_apiService</span><span class="p">.</span><span class="n">Background</span><span class="p">.</span><span class="n">GetConferences</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">return</span> <span class="n">conferences</span><span class="p">;</span></code></pre></figure>

<h3 id="akavache-1">Akavache</h3>
<p>Ya vimos cómo Akavache nos permite continuar trabajando mientras estamos offline al cachear los resultados de consultas localmente. Al combinar Akavache y las llamadas especulativas de Fusillade, podemos cachear proactivamente tantos datos como podemos mientras permanece conectado. Cuando no haya red, la app continuará funcionando en modo de solo lectura.</p>

<h2 id="manejo-de-errores">Manejo de errores</h2>
<p>En un mundo perfecto, nuestro código funcionaría correctamente todo el tiempo. Este no es un mundo perfecto. Las redes se caen. Los servicios lanzan errores. El código falla. Algunos de los errores son permanentes, pero un gran número son errores esporádicos. Las peticiones por red son poco confiables y las APIs tienen errores esporádicos por una amplia gama de razones.</p>

<h2 id="polly">Polly</h2>

<figure class="console"><pre><code>PM&gt; Install-Package Polly</code></pre></figure>

<p><a href="https://github.com/michael-wolfenden/Polly" target="_blank" rel="nofollow">Polly</a> es una de las librerías más útiles que he usado en un tiempo. De su sitio web:</p>

<blockquote>
  <p>Polly es una librería para .NET 3.5/4.0/4.5/PCL que permite a los desarrolladores expresar políticas de manejo de errores como Reintentar (<em>Retry</em>), Reintentar para siempre (<em>Retry Forever</em>), espera y reintenta (<em>Wait and Retry</em>) o corta circuito (<em>Circuit Breaker</em>) de una manera fluida.</p>
</blockquote>

<p>Polly nos permite manejar fácilmente este tipo de errores de manera consistente y coherente. En este ejemplo, trataremos de conectarnos al servicio 5 veces, con una espera que incrementa exponencialmente 2, 4, 8, 16, 32 segundos entre intentos. Esto debería darle tiempo al dispositivo de reestablecer la conexión y continuar con las peticiones.</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="n">conferences</span> <span class="p">=</span> <span class="k">await</span> <span class="n">Policy</span>  
      <span class="p">.</span><span class="n">Handle</span><span class="p">&lt;</span><span class="n">WebException</span><span class="p">&gt;()</span>
      <span class="p">.</span><span class="n">WaitAndRetry</span>
      <span class="p">(</span>
        <span class="n">retryCount</span><span class="p">:</span><span class="m">5</span><span class="p">,</span> 
        <span class="n">sleepDurationProvider</span><span class="p">:</span> <span class="n">retryAttempt</span> <span class="p">=&gt;</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="n">retryAttempt</span><span class="p">))</span>
      <span class="p">)</span>
      <span class="p">.</span><span class="n">ExecuteAsync</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">await</span> <span class="n">getConferencesTask</span><span class="p">);</span></code></pre></figure>

<h3 id="asyncerrorhandler">AsyncErrorHandler</h3>

<figure class="console"><pre><code>PM&gt; Install-Package AsyncErrorHandler.Fody</code></pre></figure>

<p>Inclusive con todo el cacheo, los reintentos y planeación que hemos puesto en el código, en algún momento fallará. Queremos que cuando eso suceda, lo manejemos de buena manera.</p>

<p>En nuestras aplicaciones móviles, es imperativo que usemos <code>async</code>/<code>await</code> tanto como podamos para asegurarnos de no bloquear el hilo de la UI mientras hacemos cosas como peticiones de red. Manejar las excepciones en métodos asíncronos puede ser complicado.</p>

<p>Agregar <a href="https://github.com/Fody/AsyncErrorHandler" target="_blank" rel="nofollow">AsyncErrorHandler</a> nos permite manejar esas excepciones de modo global, así nos aseguramos de que no terminarán nuestra app.</p>

<h2 id="más">Más</h2>
<p>Podríamos ir un paso más allá en la arquitectura de nuestro código para manejar las peticiones de red. Podríamos registrar cada llamada como una <a href="https://developer.xamarin.com/guides/ios/application_fundamentals/backgrounding/part_3_ios_backgrounding_techniques/ios_backgrounding_with_tasks/" target="_blank" rel="nofollow">BackgroundTask</a> en iOS, o como un <a href="http://developer.xamarin.com/guides/android/application_fundamentals/services/" target="_blank" rel="nofollow">Service</a> en Android para darle a cada una la oportunidad de terminar aún cuando la app es enviada a segundo plano.</p>

<p>Podríamos implementar una cola, o laguna forma de sincronización de datos que nos permitirían actualizar los datos mientras estamos offline y sincronizarlos con el servidor cuando una conexión esté disponible. Qué tan lejos quieres llegar, depende de ti.</p>

<p>Fundamentalmente, el desarrollo móvil introduce algunas complejidades por las que no habíamos tenido que preocuparnos en el desarrollo para escritorio. Una aplicación móvil que no usa servicios externos es una isla con usabilidad limitada. Una aplicación móvil que usa servicios externos, pero falla cuando trata de acceder a ellos es inútil. Al usar algunas librerías realmente geniales, podemos asegurarnos de que nuestras aplicaciones darán a nuestros usuarios la mejor experiencia.</p>

<h2 id="agradecimientos">Agradecimientos</h2>
<p>Para hacer que todo esto funcione, aproveché el gran trabajo de otros desarrolladores. <em>Sentado sobre los hombros de gigantes</em>.</p>

<p>Gracias a <a href="https://twitter.com/jamesmontemagno" target="_blank" rel="nofollow">James Montemagno</a> (<a href="http://motzcod.es/" target="_blank">Blog</a>, <a href="https://github.com/jamesmontemagno" target="_blank">GitHub</a>) por el plugin <a href="https://github.com/jamesmontemagno/Xamarin.Plugins/tree/master/Connectivity" target="_blank">Connectivity</a>.</p>

<p>Gracias a Michael Wolfenden (<a href="https://github.com/michael-wolfenden/" target="_blank">GitHub</a>) por el fantástico framework <a href="https://github.com/michael-wolfenden/Polly" target="_blank">Polly</a>.</p>

<p>Gracias a <a href="https://twitter.com/SimonCropp" target="_blank">Simon Cropp</a> (<a href="https://github.com/SimonCropp" target="_blank">GitHub</a>) por <a href="https://github.com/Fody/" target="_blank">Fody</a> y <a href="https://github.com/Fody/AsyncErrorHandler" target="_blank">AsyncErrorHandler</a>.</p>

<p>Gracias a <a href="https://twitter.com/GeoffreyHuntley" target="_blank">Geoffrey Huntley</a> (<a href="https://www.ghuntley.com/" target="_blank">Blog</a>, <a href="https://github.com/ghuntley" target="_blank">GitHub</a>) por el código y la inspiración para la clase <a href="https://gist.github.com/ghuntley/ed2eb754a47e2cd3bc90" target="_blank">ApiService con Fusillade y Refit</a>.</p>

<p>Muchas, muchas gracias a <a href="https://twitter.com/paulcbetts" target="_blank">Paul Betts</a> (<a href="http://log.paulbetts.org/" target="_blank">Blog</a>, <a href="https://github.com/paulcbetts" target="_blank">GitHub</a>) por sus trenemdas contribuciones a la comunidad <em>open source</em> de Xamarin, incluyendo <a href="https://github.com/paulcbetts/refit" target="_blank">Refit</a>, <a href="https://github.com/akavache/Akavache" target="_blank">Akavache</a>, <a href="https://github.com/paulcbetts/Fusillade" target="_blank">Fusillade</a>, y <a href="https://github.com/paulcbetts/ModernHttpClient" target="_blank">ModernHttpClient</a>.</p>

<h2 id="código-fuente">Código fuente</h2>
<p>Puedes encontrar un ejemplo completo en el <a href="https://github.com/RobGibbens/ResilientServices" target="_blank">GitHub de Rob</a>.</p>

    </article>
    <div class="post-contact">
        <div class="pure-g">
    <div class="pure-u-1 pure-u-md-7-24">
        ¿Dudas? ¿comentarios?
        <ul class="post-contact-list">
            <li><a title="feregrino@thatcsharpguy.com" href="mailto:feregrino@thatcsharpguy.com?subject=Servicios+web+resistentes+en+aplicaciones+m%C3%B3viles"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a title="@io_exception" href="https://twitter.com/intent/tweet?text=@io_exception about Servicios+web+resistentes+en+aplicaciones+m%C3%B3viles&in_reply_to=765351288318025728"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            <li><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M31 31H1V1h30v30z"/><path d="M31 2.88v16.87h-5.63v7.68l-4-2.95v2.74l-9.38.02L7.86 31H4.74v-3.7H1V12.36h5.63V2.88H31z" fill="#F6F6F6"/><path d="M19.75 23.27v2.1H12.1L6.62 29v-3.63H2.88V14.13h3.75V16H4.75v7.5H8.5v2.03l2.8-2.03h6.57v-1.62l1.88 1.4z" fill="#424242"/><path d="M17.88 6.63h9.37V16h-5.63v4.09l-3.54-3.55-.55-.55h-7.17V6.62h7.5zM8.5 4.75v13.13h8.26l6.74 5.57v-5.57h5.63V4.74H8.5z" fill="#424242"/><path d="M25.38 10.38H12.24V8.5h13.13v1.88zM21.63 14.13h-9.38v-1.88h9.38v1.88z" fill="#424242"/><path d="M8.5 25.53V23.5" fill="#F6F6F6"/><g fill="#F0EFF1"><path d="M17.88 21.88v1.62H11.3l-2.8 2.03V23.5H4.75V16h1.88v3.75h8.36l2.88 2.13zM17.88 6.63h-7.5V16h7.15l.55.55 3.55 3.54V16h5.62V6.62h-9.38zm3.75 7.5h-9.38v-1.88h9.38v1.88zm3.75-3.76H12.24V8.5h13.13v1.88z"/></g></g></svg> <a id="post-count" href="http://thatcsharpguy.com/post/servicios-web-movil-xamarin/#disqus_thread" data-disqus-identifier="/post/servicios-web-movil-xamarin/"></a></li>
        </ul>
    </div>  
    <div class="pure-u-1 pure-u-md-10-24">
        
            
        
    </div>
    <div class="pure-u-1 pure-u-md-7-24">
        Comparte esto
        <ul class="post-contact-list">
            <li><a href="mailto:?subject=Servicios web resistentes en aplicaciones móviles&amp;body=http://thatcsharpguy.com/post/servicios-web-movil-xamarin/" title="email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a href="https://twitter.com/intent/tweet?text=Servicios+web+resistentes+en+aplicaciones+m%C3%B3viles http://thatcsharpguy.com/post/servicios-web-movil-xamarin/&hashtags=Xamarin" title="Tweet"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            <li><a href="https://twitter.com/intent/retweet?tweet_id=765351288318025728" title="Retweet"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="#000" fill-rule="evenodd" d="M30.86 16.55c-.225-.445-.682-.726-1.18-.726h-3.09v-7.06C26.59 7.79 25.8 7 24.827 7H14.678c-.975 0-1.765.79-1.765 1.765 0 .975.79 1.765 1.765 1.765h7.942c.243 0 .44.197.44.44v4.854h-3.088c-.498 0-.955.28-1.18.726-.225.445-.182.98.113 1.38l4.853 6.62c.25.34.647.54 1.068.54.42 0 .818-.2 1.067-.54l4.854-6.62c.295-.402.338-.935.113-1.38zm-13.535 5.01H9.383c-.238 0-.428-.188-.438-.423l-.003-4.87h3.088c.5 0 .956-.282 1.18-.727.226-.445.183-.98-.112-1.38L8.245 7.54C7.995 7.2 7.6 7 7.177 7c-.422 0-.818.2-1.068.54l-4.854 6.62c-.295.402-.34.935-.113 1.38.225.445.682.726 1.18.726h3.09l.004 7.06c0 .975.79 1.764 1.765 1.764h10.144c.974 0 1.765-.79 1.765-1.765 0-.975-.79-1.765-1.764-1.765z"/></svg></a></li>
            <li><a href="javascript:sharePostFacebook();" title="share" ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg></a> </li>
            <li><a class="kindleWidget" href="#" title="send to kindle"> <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 32 32">
  <path fill-rule="evenodd" d="M1 3c0-1.1.9-2 2-2h26c1.1 0 2 .9 2 2v26c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3zm8.4-.3V29h3.2v-8.72h.07L19.54 29h3.8l-8.07-10.06 7.34-7.5h-3.7l-6.2 6.36h-.08V2.7H9.4z"/>
</svg> </a> </li>
        </ul>
    </div>
</div>
<script>
    function sharePostFacebook() {
        FB.ui({
  method: 'share',
  href: 'http://thatcsharpguy.com/post/servicios-web-movil-xamarin/',
}, function(response){});
    }
</script>
<script type="text/javascript" src="https://d1xnn692s7u6t6.cloudfront.net/widget.js"></script>
<script type="text/javascript">(function k(){window.$SendToKindle&&window.$SendToKindle.Widget?$SendToKindle.Widget.init({}):setTimeout(k,500);})();</script>
    </div>
</div>


<div id="disqus_thread"></div>
<script id="dsq-count-scr" src="//thatcharpguy.disqus.com/count.js" async></script>
<script>
    var noCommentsText = "deja un comentario";
    var commentText = " comentario";
    
//var disqus_developer = 1; // this would set it to developer mode

    var disqus_config = function () {
        this.page.url = "http://thatcsharpguy.com/post/servicios-web-movil-xamarin/"; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = "/post/servicios-web-movil-xamarin/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.title ="Servicios web resistentes en aplicaciones móviles";
    };
</script>
<script src="/js/comments.js"></script>

      </div>
    </div>

    <footer class="site-footer ui">
  <div class="wrapper pure-g">
      <div class="pure-u-1 pure-u-md-8-24">
          <div class="footer-content">
              <ul class="icon-list">
    <li id="em">
        <a href="mailto:feregrino@thatcsharpguy.com" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg>
        </a>
    </li>
    <li id="gh">
        <a href="https://github.com/ThatCSharpGuy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 16.37q0 4.9-2.86 8.8-2.86 3.93-7.4 5.43-.52.1-.77-.13-.24-.24-.24-.6v-4.1q0-1.9-1.02-2.78 1.2-.2 2.1-.4.9-.3 1.87-.8.95-.5 1.58-1.3.65-.8 1.05-2.1.4-1.27.4-2.93 0-2.38-1.54-4.04.7-1.78-.16-3.98-.57-.2-1.6.2t-1.8.85l-.75.47q-1.83-.5-3.76-.5t-3.76.5l-.8-.54Q11 8.16 9.9 7.7q-1.13-.4-1.7-.23-.86 2.2-.14 3.97-1.54 1.68-1.54 4.05 0 1.6.4 2.9.4 1.23 1.02 2.02.63.8 1.58 1.3.94.53 1.83.77.9.25 2 .37-.77.7-.94 2-.4.2-.82.3-.47.1-1.1.1-.66 0-1.3-.44-.63-.4-1.08-1.2-.38-.63-.95-1-.52-.4-.9-.5l-.4-.03q-.4 0-.57.1-.15.1-.1.24.06.13.18.26t.26.2l.15.1q.44.2.86.73t.63 1l.2.43q.23.75.84 1.2.6.47 1.3.6.7.13 1.34.14.65 0 1.08-.04l.46-.08v2.74q0 .35-.26.6-.25.22-.8.12-4.5-1.5-7.37-5.42-3-3.74-3-8.64 0-4.1 2-7.54 2-3.44 5.45-5.46 3.45-2 7.53-2t7.6 2q3.4 2 5.4 5.46 2 3.44 2 7.53z"/></svg>
        </a>
    </li>
    <li id="yt">
        <a href="https://www.youtube.com/c/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M22.43 15.714c0-.413-.17-.714-.504-.904l-8.57-5.357c-.347-.223-.71-.234-1.09-.033-.368.2-.552.513-.552.937V21.07c0 .426.184.738.553.94.178.088.35.133.52.133.222 0 .412-.056.568-.168l8.57-5.357c.336-.19.504-.49.504-.904zm8.57 0c0 1.072-.006 1.91-.017 2.51-.01.604-.058 1.366-.142 2.287-.083.92-.208 1.744-.376 2.47-.178.815-.563 1.5-1.155 2.06-.592.557-1.284.88-2.077.97-2.477.28-6.222.42-11.233.42-5.01 0-8.756-.14-11.233-.42-.793-.09-1.487-.413-2.085-.97-.597-.56-.984-1.245-1.163-2.06-.157-.726-.277-1.55-.36-2.47-.085-.92-.132-1.682-.143-2.285-.01-.602-.017-1.44-.017-2.51 0-1.072.006-1.91.017-2.512.01-.603.058-1.364.142-2.285.083-.92.208-1.744.376-2.47.178-.814.563-1.5 1.155-2.058.592-.56 1.284-.882 2.077-.97C7.244 5.14 10.99 5 16 5c5.01 0 8.756.14 11.233.42.793.088 1.487.41 2.085.97.597.558.984 1.244 1.163 2.06.157.724.277 1.547.36 2.468.085.92.132 1.682.143 2.285.01.603.017 1.44.017 2.51z"/></svg>
        </a>
    </li>
    <li id="tw">
        <a href="https://twitter.com/io_exception" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg>
        </a>
    </li>    
    <li id="fb">
        <a href="https://www.facebook.com/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg>
        </a>
    </li>
    <li id="gp">
        <a href="https://www.google.com/+Thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.9 14.25h-2.7v-2.72h-2.73v2.72h-2.7v2.72h2.7v2.7h2.72v-2.7h2.7v-2.72M10.5 17.5h5.4c-.22 1.4-1.64 4.12-5.4 4.12-3.25 0-5.9-2.7-5.9-6 0-3.33 2.65-6.02 5.9-6.02 1.85 0 3.08.78 3.8 1.46l2.58-2.48c-1.66-1.55-3.8-2.5-6.38-2.5C5.26 6.1 1 10.35 1 15.62s4.26 9.52 9.52 9.52c5.5 0 9.14-3.86 9.14-9.3 0-.62-.07-1.1-.15-1.57h-8.96"/></svg>
        </a>
    </li>
</ul>
<ul class="icon-list">
    <li>
        <a href="/acerca-de">
            <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M7 18.89v-5.88H1.15v-6H7V1.1h6v5.91h6V1.1h6v5.91h5.85v6H25v5.88h5.85v6H25v5.912h-6v-5.91h-6v5.91H7v-5.91H1.15v-6H7zm6 0v-5.88h6v5.88h-6z" fill="#3C8A3F" fill-rule="evenodd"/></svg>
        </a>
    </li>
</ul>
          </div>
      </div>
      <div class="pure-u-1 pure-u-md-6-24">
      </div>
      <div class="pure-u-1 pure-u-md-10-24">
          <div class="footer-content">
              <div class="panel active" id="footer-signup">
    <div class="panel-title">
        <span class="title">Suscríbete</span>
    </div>
    <div class="panel-content">
    Recibe semanalmente lo nuevo en That C# guy
    <form class="pure-form-stacked" action="//thatcsharpguy.us11.list-manage.com/subscribe/post?u=ebfe25f4824d7335380cf1ffd&amp;id=eca72e1174" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
                
                <input type="email" value="" placeholder="dirección de email" name="EMAIL" class="required email" id="mce-EMAIL">
                
                <button type="submit" name="subscribe" id="mc-embedded-subscribe" class="button">
                    <span style="text-decoration:underline;">E</span>nviar
                </button>
                <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true">
                    <input type="text" name="b_ebfe25f4824d7335380cf1ffd_eca72e1174" tabindex="-1" value="">
                </div>
    </form>
    </div>
</div>
          </div>
      </div>
  </div>
</footer>
   
  </body>

</html>
