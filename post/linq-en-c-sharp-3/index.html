<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
<head>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/site/apple-touch-icon.png?v=new">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/site/favicon-32x32.png?v=new">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/site/favicon-16x16.png?v=new">
  <link rel="manifest" href="/assets/site/site.webmanifest?v=new">
  <link rel="mask-icon" href="/assets/site/safari-pinned-tab.svg?v=new" color="#3c8a3f">
  <link rel="shortcut icon" href="/assets/site/favicon.ico?v=new">
  <meta name="msapplication-TileColor" content="#3c8a3f">
  <meta name="theme-color" content="#eeeef2">

  <title>Linq en C# - tercera parte - That CS guy</title>
  <meta name="description" content="Esta es la tercera parte de la serie sobre LINQ en donde hablaré sobre cómo trabajar con dos conjuntos de datos diferentes, con ellos se pueden realizar unio...">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://thatcsharpguy.com/post/linq-en-c-sharp-3/">
  <link rel="alternate" type="application/rss+xml" title="That CS guy" href="http://thatcsharpguy.com/feed.xml" />
  <!-- Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-94016385-1', 'auto');
    ga('send', 'pageview');
  </script>


  <!-- Twitter cards  -->
	 
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:image" content="http://thatcsharpguy.com/postimages/linq-en-c-sharp/featured.png">
	
	<meta name="twitter:site" content="@io_exception" />
	<meta name="twitter:title" content="Linq en C# - tercera parte" />
	<meta name="twitter:description" content="Esta es la tercera parte de la serie sobre LINQ en donde hablaré sobre cómo trabajar con dos conjuntos de datos diferentes, con ellos se pueden realizar unio..." />


    <!-- Facebook open graph tags -->  
    
    <meta property="og:image" content="http://thatcsharpguy.com/postimages/linq-en-c-sharp/featured.png" />
    
    
    <meta property="og:title" content="Linq en C# - tercera parte" />
    <meta property="og:site_name" content="That CS guy"/>
    <meta property="og:url" content="http://thatcsharpguy.com/post/linq-en-c-sharp-3/">
    <meta property="og:description" content="Esta es la tercera parte de la serie sobre LINQ en donde hablaré sobre cómo trabajar con dos conjuntos de datos diferentes, con ellos se pueden realizar unio..." />
    <meta property="article:author" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="article:publisher" content="https://www.facebook.com/antonio.feregrino" />
    <meta property="fb:app_id" content="942345702508916" />
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/masonry/3.3.2/masonry.pkgd.min.js"></script>

</head>
  <body>

    <header class="site-header ui">
  <div class="wrapper menu">
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
        <a class="link page-link" href="/">Inicio</a>
        
        <a class="link page-link" href="/tv">TV</a>
        
        <a class="link page-link" href="/acerca-de">Acerca de</a>
        
        <a class="link page-link" href="/tag">Tags</a>
        
        <a class="link page-link" href="/busqueda">Buscar</a>
        
        <a class="link page-link" href="/suscribete">Suscríbete</a>
        
        <a class="link page-link" href="/herramientas">Herramientas</a>
        
        <a class="link page-link" href="/libros">Libros</a>
        
      </div>
    </nav>
  </div>
  <div class="wrapper title">
    <div class="pure-g">
      <div class="pure-u-1-24 title-number"><span>1</span></div>
      <div class="pure-u-13-24 content-window">
        <a class="site-title" href="/">That CS guy</a>
      </div>
      <div class="pure-u-10-24 header-menu">
        <ul>
          <li class="youtube"><a href="https://www.youtube.com/c/thatcsharpguy">YouTube</a></li>
          <li class="csharp"><a href="http://thatcsharpguy.com/tag/AprendeCSharp/">Aprende C#</a></li>
          <li class="xamarin"><a href="http://thatcsharpguy.com/tag/Xamarin/">Xamarin</a></li>
        </ul>
      </div>
    </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div id="post-meta">
    <a href="/acerca-de/#citando" rel="author">Antonio Feregrino</a> | 08/02/2016
 

| <strong><a href="https://github.com/ThatCSharpGuy/aprende-c-sharp/tree/master/linq-en-c-sharp-3" target="_blank"><i class="sp sp-git"></i> Ver código de este post en GitHub</a></strong>

</div>
<h1 class="post-title">Linq en C# - tercera parte</h1>
<div class="post-content">

    <article>
        <p>Inmediatamente después de la <a href="/post/linq-en-c-sharp-2">segunda parte de la serie de posts sobre Linq</a>, les traigo este, que es la tercera parte en donde hablaré sobre cómo trabajar con dos conjuntos de datos diferentes, con ellos se pueden realizar uniones y agrupaciones para obtener más conocimiento de la información que tenemos.</p>

<h3 id="preparando-el-terreno">Preparando el terreno</h3>
<p>Nuevamente en este post me auxiliaré de los mismos elementos que en el post pasado: Las clases <code>Lecture</code>, <code>Teacher</code> y <code>FakeDatabase</code></p>

<h2 id="agrupamientos-group-by--groupby">Agrupamientos (group by , GroupBy)</h2>
<p>Con Linq también podemos realizar agrupamientos de datos, esta función está disponible tanto en la sintaxis de método como en la de consulta y a mi parecer es mucho más entendible en la de consulta. Es importante señalar que cuando ejecutamos un agrupamiento tendremos acceso a una nueva colección de tipo <code>IGrouping</code>, y cada uno de esos <code>IGrouping</code>s contiene una propiedad <code>Key</code> que es del tipo de dato sobre el que ejecutamos el agrupamiento. Podríamos er un ejemplo sencillo si queremos saber cuantas clases tiene cada profesor:</p>

<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">classesPerTeacherQuery</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">lecture</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Lectures</span>
    <span class="k">group</span> <span class="n">lecture</span> <span class="k">by</span> <span class="n">lecture</span><span class="p">.</span><span class="n">TeacherId</span> <span class="k">into</span> <span class="n">grp</span>
    <span class="k">select</span> <span class="k">new</span>
    <span class="p">{</span>
        <span class="n">TeacherId</span> <span class="p">=</span> <span class="n">grp</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span>
        <span class="n">LectureCount</span> <span class="p">=</span> <span class="n">grp</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span>
    <span class="p">};</span></code></pre></figure>
  
</div>
<div class="pure-u-1 pure-u-md-1-2">

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">classesPerTeacherMethod</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Lectures</span>
    <span class="p">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="n">lecture</span> <span class="p">=&gt;</span> <span class="n">lecture</span><span class="p">.</span><span class="n">TeacherId</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">grp</span> <span class="p">=&gt;</span>
        <span class="k">new</span>
        <span class="p">{</span>
            <span class="n">TeacherId</span> <span class="p">=</span> <span class="n">grp</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span>
            <span class="n">LectureCount</span> <span class="p">=</span> <span class="n">grp</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span>
        <span class="p">});</span></code></pre></figure>
  
</div>  
</div>

<p>En este caso estamos agrupando las clases por maestro, a través de su llave <code>TeacherId</code>. Como se puede ver, cuando usamos la sintaxis de consulta es necesario especificar otro nombre para la colección resultante del agrupamiento, en este caso la llamamos <code>grp</code>, mientras que en la sintaxis de método no es necesario. Posteriormente podemos seguir trabajando con la colección agrupada, como en este caso que estamos creando un tipo anónimo con el Id del profesor y la cantidad de clases que imparten.</p>

<p>En un ejemplo más complejo podríamos agrupar las clases que da cada maestro y luego agruparlas por nivel para después imprimirlas en pantalla:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">groupedLecturesPerLevelAndTeacher</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">lecture</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Lectures</span>
    <span class="k">group</span> <span class="n">lecture</span> <span class="k">by</span> <span class="n">lecture</span><span class="p">.</span><span class="n">TeacherId</span> <span class="k">into</span> <span class="n">group1</span>
    <span class="k">select</span> <span class="k">new</span>
    <span class="p">{</span>
        <span class="n">TeacherId</span> <span class="p">=</span> <span class="n">group1</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span>
        <span class="n">Levels</span> <span class="p">=</span> <span class="k">from</span> <span class="n">level</span> <span class="k">in</span> <span class="n">group1</span>
                 <span class="k">group</span> <span class="n">level</span> <span class="k">by</span> <span class="n">level</span><span class="p">.</span><span class="n">Level</span> <span class="k">into</span> <span class="n">group2</span>
                 <span class="k">select</span> <span class="k">new</span>
                 <span class="p">{</span>
                    <span class="n">LevelName</span> <span class="p">=</span> <span class="n">group2</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span>
                    <span class="n">Lectures</span> <span class="p">=</span> <span class="n">group2</span><span class="p">.</span><span class="n">ToList</span><span class="p">()</span>
                 <span class="p">}</span>
    <span class="p">};</span></code></pre></figure>

<p>En este caso se puede decir que estamos haciendo un agrupamiento anidado: Primero estamos agrupando las <code>Lecture</code>s por el maestro que las imparte, el resultado de esta agrupación lo estamos colocando en <code>group1</code>, después, mediante la cláusula <code>select</code> estamos creando un nuevo tipo que tiene como propiedades <code>TeacherId</code> y <code>Level</code> que es creado a de la agrupación de las clases por la propiedad <code>Level</code> (que ponemos en <code>group2</code>) para posteriormente crear una colección de objetos con <code>LevelName</code> y <code>Lectures</code>.</p>

<p>También se pueden hacer agrupamientos un poco más complejas cuando usamos la sintaxis de método, ya que permite especificar una instancia de clase que implementa la interfaz <code>IEqualityComparer&lt;T&gt;</code> mediante la cual se implementa el método <code>Equals(T, T)</code> que indica cómo se van a agrupar los elementos.</p>

<h2 id="uniones-join-join">Uniones (join, Join)</h2>
<p>Una de las características más interesantes de Linq es la de poder hacer uniones entre conjuntos de datos a partir de una propiedad en ellos, la forma de hacer los <em>join</em> en Linq es muy similar a la forma en que se realizan los <code>inner join</code> en SQL puesto que es necesario especificar un campo sobre el que se realizará la unión:</p>

<p>En las consultas anteriores sobre <code>db.Lectures</code> únicamente tenemos acceso a <code>TeacherId</code>, pero supongamos que también queremos acceder a la información del profesor asignado a una clase. Es ahí cuando debemos hacer un <code>join</code>:</p>

<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">q5</span> <span class="p">=</span>
    <span class="k">from</span> <span class="n">l</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Lectures</span>
    <span class="k">group</span> <span class="n">l</span> <span class="k">by</span> <span class="n">l</span><span class="p">.</span><span class="n">TeacherId</span> <span class="k">into</span> <span class="n">grouped</span>
    <span class="k">join</span> <span class="n">t</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Teachers</span> <span class="k">on</span> <span class="n">grouped</span><span class="p">.</span><span class="n">Key</span> <span class="k">equals</span> <span class="n">t</span><span class="p">.</span><span class="n">Id</span>
    <span class="k">select</span> <span class="k">new</span>
    <span class="p">{</span>
        <span class="n">TeacherName</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="n">GivenName</span><span class="p">,</span>
        <span class="n">TeacherId</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
        <span class="n">LectureCount</span> <span class="p">=</span> <span class="n">grouped</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span>
    <span class="p">};</span></code></pre></figure>
  
</div>
<div class="pure-u-1 pure-u-md-1-2">

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">q5alt</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">Lectures</span>
    <span class="p">.</span><span class="n">GroupBy</span><span class="p">(</span><span class="n">l</span> <span class="p">=&gt;</span> <span class="n">l</span><span class="p">.</span><span class="n">TeacherId</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Join</span><span class="p">(</span><span class="n">db</span><span class="p">.</span><span class="n">Teachers</span><span class="p">,</span> <span class="n">grouped</span> <span class="p">=&gt;</span> <span class="n">grouped</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span> <span class="n">t</span> <span class="p">=&gt;</span> <span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
    <span class="p">(</span><span class="n">grouped</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">new</span>
    <span class="p">{</span>
        <span class="n">TeacherName</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="n">GivenName</span><span class="p">,</span>
        <span class="n">TeacherId</span> <span class="p">=</span> <span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
        <span class="n">LectureCount</span> <span class="p">=</span> <span class="n">grouped</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span>
    <span class="p">});</span></code></pre></figure>
  
</div>  
</div>

<p>Definitivamente hacer los <em>join</em> en la sintaxis de consulta es la mejor opción puesto que se convierten en una instrucción más legible. En el código anterior podemos ver que el <em>join</em> se compone de tres palabras:</p>

<ul>
  <li>Un alias que va después de la palabra <code>join</code></li>
  <li>Un origen de datos que va después de la palabra <code>in</code></li>
  <li>Una condición bajo la que se realizará la unión después de la palabra <code>on</code></li>
</ul>

<p>Si has escrito SQL seguramente te resultará conocida esta sintaxis.</p>

<h2 id="operaciones-de-un-elemento-first-single-elementat">Operaciones de un elemento (First, Single, ElementAt)</h2>
<p>Como vimos antes, podemos usar <code>Take</code> para obtener una cantidad fija de elementos de una secuencia, sin embargo, para obtener uno solo es recomendable usar los métodos como <code>Single</code>, <code>First</code> o <code>ElementAt</code> y sus similares para dicha tarea. Estos métodos no están disponibles a través de la sintaxis de consulta, únicamente a través de la de método.</p>

<p>Por ejemplo, vamos a trabajar con un conjunto de maestros ordenados por su apellido:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">q6</span> <span class="p">=</span> <span class="k">from</span> <span class="n">l</span> <span class="k">in</span> <span class="n">db</span><span class="p">.</span><span class="n">Teachers</span>
            <span class="k">orderby</span> <span class="n">l</span><span class="p">.</span><span class="n">LastName</span> <span class="k">descending</span>
            <span class="k">select</span> <span class="n">l</span><span class="p">;</span></code></pre></figure>

<h3 id="first">First</h3>

<p>Si queremos obtener el primer maestro:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">maestro1</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">First</span><span class="p">();</span></code></pre></figure>

<p><code>First</code> también acepta una condicional, digamos que queremos obtener el primer maestro que tiene como nombre “Cosme Fulanito”:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">cosmeFulanito</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">First</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">GivenName</span> <span class="p">==</span> <span class="s">&quot;Cosme&quot;</span> <span class="p">&amp;&amp;</span> <span class="n">m</span><span class="p">.</span><span class="n">LastName</span> <span class="p">==</span> <span class="s">&quot;Fulanito&quot;</span><span class="p">);</span></code></pre></figure>

<p>Con este tipo de operaciones debemos ser muy cuidadosos, porque en el ejemplo pasado, al no existir un maestro llamado “Cosme Fulanito”, el método <code>First</code> lanza una excepción del tipo <code>InvalidOperationException</code>, lo cual ocurre si el conjunto sobre el que operamos no contiene elemento alguno que cumpla la condición (o si no indicamos condición basta con que el conjunto esté vacío).</p>

<p>Para evitar la excepción podemos usar el método <code>FirstOrDefault</code> el cual regresará el valor por default del elemento del conjunto sobre el que trabajamos, hay que recordar que el valor por default de un tipo por referencia es <code>null</code>:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">cosmeFulanito2</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">GivenName</span> <span class="p">==</span> <span class="s">&quot;Cosme&quot;</span> <span class="p">&amp;&amp;</span> <span class="n">m</span><span class="p">.</span><span class="n">LastName</span> <span class="p">==</span> <span class="s">&quot;Fulanito&quot;</span><span class="p">);</span></code></pre></figure>

<h3 id="single">Single</h3>

<p>Adicionalmente a <code>First</code>, también existe el método <code>Single</code> y <code>SingleOrDefault</code> <strong>pero solamente deben ser usados cuando el conjunto sobre el que operan únicamente contiene 1 solo elemento</strong>, ya que de otro modo obtendremos una espantosa excepción, por ejemplo, si ejecutáramos <code>Single</code> sobre <code>q6</code> obtendríamos una excepción porque tenemos más de 1 maestro en nuestra base de datos falsa:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">maestro3</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">Single</span><span class="p">();</span> <span class="c1">// Excepción porque q6 contiene más de 1 elemento</span></code></pre></figure>

<p>Tal vez te estés preguntando para qué existe <code>Single</code> si ya existe <code>First</code> y yo al igual que muchos coincido en que todo es cuestión de semántica en nuestro código. Si queremos dejar claro que una consulta a la base de datos, a un XML o a cualquier otra cosa a través de Linq debe siempre regresar un solo resultado debemos usar <code>Single</code>, si esperamos obtener el primer resultado de un conjunto más grande debemos usar <code>First</code>.</p>

<h3 id="elementat">ElementAt</h3>
<p>No no siempre vamos a necesitar el primer elemento de una colección, tal vez estemos buscando el segundo, el décimo o el noningentésimo… uno nunca sabe. Para realizar esta tarea tenemos a nuestra mano el método <code>ElementAt</code> que obtiene el elemento colocado en la posición especificada mediante un entero:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">maestroSegundo</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">2</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">maestroDecimo</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">10</span><span class="p">);</span></code></pre></figure>

<p>En este caso también debemos ser cuidadosos ya que, si nuestro conjunto no contiene al menos la cantidad de elementos necesaria para cumplir nuestra petición, obtendremos otra excepción, en este caso una del tipo <code>ArgumentOutOfRangeException</code>, así pues que cuando se solicita al maestro 900 obtendremos el error:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span></span><span class="kt">var</span> <span class="n">maestroNoningentesimo</span> <span class="p">=</span> <span class="n">q6</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="m">900</span><span class="p">);</span> <span class="c1">// Excepción ¡porque q6 no tiene 900 maestros!</span></code></pre></figure>

<h4 id="lo-que-sigue">Lo que sigue</h4>
<p>Aún quedan algunas cuantas herramientas de Linq por demostrar, entre ellas las intersecciones, uniones y demás operaciones sobre conjuntos que se pueden realizar. Sin duda espero haberte convencido (o demostrado) que el poder de esta característica que nos ofrece .NET es bastante bueno y que no debe pasarse por alto cuando desarrollas. Como siempre, recuerda que todo el código fuente de este post está en la información (cerca del título).</p>

    </article>
    <div class="post-contact">
        <div class="pure-g">
    <div class="pure-u-1 pure-u-md-7-24">
        ¿Dudas? ¿comentarios?
        <ul class="post-contact-list">
            <li><a title="feregrino@thatcsharpguy.com" href="mailto:feregrino@thatcsharpguy.com?subject=Linq+en+C%23+-+tercera+parte"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a title="@io_exception" href="https://twitter.com/intent/tweet?text=@io_exception about Linq+en+C%23+-+tercera+parte"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            <li><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M31 31H1V1h30v30z"/><path d="M31 2.88v16.87h-5.63v7.68l-4-2.95v2.74l-9.38.02L7.86 31H4.74v-3.7H1V12.36h5.63V2.88H31z" fill="#F6F6F6"/><path d="M19.75 23.27v2.1H12.1L6.62 29v-3.63H2.88V14.13h3.75V16H4.75v7.5H8.5v2.03l2.8-2.03h6.57v-1.62l1.88 1.4z" fill="#424242"/><path d="M17.88 6.63h9.37V16h-5.63v4.09l-3.54-3.55-.55-.55h-7.17V6.62h7.5zM8.5 4.75v13.13h8.26l6.74 5.57v-5.57h5.63V4.74H8.5z" fill="#424242"/><path d="M25.38 10.38H12.24V8.5h13.13v1.88zM21.63 14.13h-9.38v-1.88h9.38v1.88z" fill="#424242"/><path d="M8.5 25.53V23.5" fill="#F6F6F6"/><g fill="#F0EFF1"><path d="M17.88 21.88v1.62H11.3l-2.8 2.03V23.5H4.75V16h1.88v3.75h8.36l2.88 2.13zM17.88 6.63h-7.5V16h7.15l.55.55 3.55 3.54V16h5.62V6.62h-9.38zm3.75 7.5h-9.38v-1.88h9.38v1.88zm3.75-3.76H12.24V8.5h13.13v1.88z"/></g></g></svg> <a id="post-count" href="http://thatcsharpguy.com/post/linq-en-c-sharp-3/#disqus_thread" data-disqus-identifier="/post/linq-en-c-sharp-3/"></a></li>
        </ul>
    </div>  
    <div class="pure-u-1 pure-u-md-10-24">
        
            ¿Quieres ver más como esto? revisa la etiqueta  <a class="tag" href="/tag/AprendeCSharp">#AprendeCSharp</a>.
        
    </div>
    <div class="pure-u-1 pure-u-md-7-24">
        Comparte esto
        <ul class="post-contact-list">
            <li><a href="mailto:?subject=Linq en C# - tercera parte&amp;body=http://thatcsharpguy.com/post/linq-en-c-sharp-3/" title="email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg></a></li>
            <li><a href="https://twitter.com/intent/tweet?text=Linq+en+C%23+-+tercera+parte http://thatcsharpguy.com/post/linq-en-c-sharp-3/&hashtags=AprendeCSharp" title="Tweet"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg></a></li>
            
            <li><a href="javascript:sharePostFacebook();" title="share" ><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg></a> </li>
            <li><a class="kindleWidget" href="#" title="send to kindle"> <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 32 32">
  <path fill-rule="evenodd" d="M1 3c0-1.1.9-2 2-2h26c1.1 0 2 .9 2 2v26c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3zm8.4-.3V29h3.2v-8.72h.07L19.54 29h3.8l-8.07-10.06 7.34-7.5h-3.7l-6.2 6.36h-.08V2.7H9.4z"/>
</svg> </a> </li>
        </ul>
    </div>
</div>
<script>
    function sharePostFacebook() {
        FB.ui({
  method: 'share',
  href: 'http://thatcsharpguy.com/post/linq-en-c-sharp-3/',
}, function(response){});
    }
</script>
<script type="text/javascript" src="https://d1xnn692s7u6t6.cloudfront.net/widget.js"></script>
<script type="text/javascript">(function k(){window.$SendToKindle&&window.$SendToKindle.Widget?$SendToKindle.Widget.init({}):setTimeout(k,500);})();</script>
    </div>
</div>


<div id="disqus_thread"></div>
<script id="dsq-count-scr" src="//thatcharpguy.disqus.com/count.js" async></script>
<script>
    var noCommentsText = "deja un comentario";
    var commentText = " comentario";
    
//var disqus_developer = 1; // this would set it to developer mode

    var disqus_config = function () {
        this.page.url = "http://thatcsharpguy.com/post/linq-en-c-sharp-3/"; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = "/post/linq-en-c-sharp-3/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.title ="Linq en C# - tercera parte";
    };
</script>
<script src="/js/comments.js"></script>

      </div>
    </div>

    <footer class="site-footer ui">
  <div class="wrapper pure-g">
      <div class="pure-u-1 pure-u-md-8-24">
          <div class="footer-content">
              <ul class="icon-list">
    <li id="em">
        <a href="mailto:feregrino@thatcsharpguy.com" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 11.815v13.292q0 1.105-.787 1.892-.787.78-1.892.78H3.68q-1.106 0-1.893-.79Q1 26.21 1 25.102v-13.29q.737.82 1.69 1.46 6.06 4.12 8.32 5.78.955.705 1.55 1.1.594.392 1.582.802.987.41 1.84.41h.035q.854 0 1.84-.41.99-.41 1.583-.804.595-.393 1.55-1.096 2.845-2.06 8.336-5.778.954-.652 1.674-1.455zm0-4.922q0 1.322-.82 2.528t-2.043 2.06l-7.835 5.44-.71.51q-.545.4-.905.64t-.87.55q-.51.3-.963.45-.452.15-.837.15h-.034q-.385 0-.837-.15-.452-.15-.962-.45-.51-.302-.87-.544-.36-.243-.905-.637l-.72-.51q-1.525-1.07-4.388-3.055-2.86-1.984-3.43-2.386-1.04-.704-1.96-1.935Q1 8.315 1 7.26q0-1.305.695-2.175.695-.87 1.984-.87h24.64q1.09 0 1.88.786.792.79.792 1.9z"/></svg>
        </a>
    </li>
    <li id="gh">
        <a href="https://github.com/ThatCSharpGuy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 16.37q0 4.9-2.86 8.8-2.86 3.93-7.4 5.43-.52.1-.77-.13-.24-.24-.24-.6v-4.1q0-1.9-1.02-2.78 1.2-.2 2.1-.4.9-.3 1.87-.8.95-.5 1.58-1.3.65-.8 1.05-2.1.4-1.27.4-2.93 0-2.38-1.54-4.04.7-1.78-.16-3.98-.57-.2-1.6.2t-1.8.85l-.75.47q-1.83-.5-3.76-.5t-3.76.5l-.8-.54Q11 8.16 9.9 7.7q-1.13-.4-1.7-.23-.86 2.2-.14 3.97-1.54 1.68-1.54 4.05 0 1.6.4 2.9.4 1.23 1.02 2.02.63.8 1.58 1.3.94.53 1.83.77.9.25 2 .37-.77.7-.94 2-.4.2-.82.3-.47.1-1.1.1-.66 0-1.3-.44-.63-.4-1.08-1.2-.38-.63-.95-1-.52-.4-.9-.5l-.4-.03q-.4 0-.57.1-.15.1-.1.24.06.13.18.26t.26.2l.15.1q.44.2.86.73t.63 1l.2.43q.23.75.84 1.2.6.47 1.3.6.7.13 1.34.14.65 0 1.08-.04l.46-.08v2.74q0 .35-.26.6-.25.22-.8.12-4.5-1.5-7.37-5.42-3-3.74-3-8.64 0-4.1 2-7.54 2-3.44 5.45-5.46 3.45-2 7.53-2t7.6 2q3.4 2 5.4 5.46 2 3.44 2 7.53z"/></svg>
        </a>
    </li>
    <li id="yt">
        <a href="https://www.youtube.com/c/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M22.43 15.714c0-.413-.17-.714-.504-.904l-8.57-5.357c-.347-.223-.71-.234-1.09-.033-.368.2-.552.513-.552.937V21.07c0 .426.184.738.553.94.178.088.35.133.52.133.222 0 .412-.056.568-.168l8.57-5.357c.336-.19.504-.49.504-.904zm8.57 0c0 1.072-.006 1.91-.017 2.51-.01.604-.058 1.366-.142 2.287-.083.92-.208 1.744-.376 2.47-.178.815-.563 1.5-1.155 2.06-.592.557-1.284.88-2.077.97-2.477.28-6.222.42-11.233.42-5.01 0-8.756-.14-11.233-.42-.793-.09-1.487-.413-2.085-.97-.597-.56-.984-1.245-1.163-2.06-.157-.726-.277-1.55-.36-2.47-.085-.92-.132-1.682-.143-2.285-.01-.602-.017-1.44-.017-2.51 0-1.072.006-1.91.017-2.512.01-.603.058-1.364.142-2.285.083-.92.208-1.744.376-2.47.178-.814.563-1.5 1.155-2.058.592-.56 1.284-.882 2.077-.97C7.244 5.14 10.99 5 16 5c5.01 0 8.756.14 11.233.42.793.088 1.487.41 2.085.97.597.558.984 1.244 1.163 2.06.157.724.277 1.547.36 2.468.085.92.132 1.682.143 2.285.01.603.017 1.44.017 2.51z"/></svg>
        </a>
    </li>
    <li id="tw">
        <a href="https://twitter.com/io_exception" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M31 6.7q-1.28 1.88-3.08 3.2.02.26.02.8 0 2.46-.73 4.93-.7 2.46-2.2 4.73-1.46 2.26-3.5 4-2.04 1.75-4.9 2.8-2.88 1.02-6.16 1.02-5.16 0-9.44-2.76.67.08 1.48.08 4.3 0 7.64-2.63-2-.04-3.58-1.23-1.58-1.2-2.17-3.03.63.1 1.16.1.82 0 1.62-.2-2.13-.44-3.53-2.13-1.4-1.68-1.4-3.9v-.1q1.3.74 2.78.8-1.26-.84-2-2.2-.74-1.35-.74-2.93 0-1.67.83-3.1 2.3 2.84 5.6 4.54 3.3 1.7 7.07 1.9-.15-.73-.15-1.4 0-2.57 1.8-4.36 1.8-1.8 4.35-1.8 2.66 0 4.5 1.94 2.07-.4 3.9-1.5-.7 2.2-2.7 3.4 1.76-.2 3.53-.95z"/></svg>
        </a>
    </li>    
    <li id="fb">
        <a href="https://www.facebook.com/thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.512 1.488c.325.326.488.716.488 1.172v26.68c0 .456-.163.846-.488 1.172-.326.325-.716.488-1.172.488h-7.637V19.38h3.887l.586-4.532h-4.473v-2.89c0-.73.153-1.277.46-1.642.305-.364.9-.546 1.786-.546l2.382-.02V5.707c-.82-.117-1.98-.176-3.477-.176-1.77 0-3.186.522-4.248 1.564-1.06 1.04-1.59 2.513-1.59 4.414v3.34h-3.908v4.53h3.906V31H2.66c-.456 0-.846-.163-1.172-.488C1.163 30.186 1 29.796 1 29.34V2.66c0-.456.163-.846.488-1.172C1.814 1.163 2.204 1 2.66 1h26.68c.456 0 .846.163 1.172.488z"/></svg>
        </a>
    </li>
    <li id="gp">
        <a href="https://www.google.com/+Thatcsharpguy" class="contact">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.9 14.25h-2.7v-2.72h-2.73v2.72h-2.7v2.72h2.7v2.7h2.72v-2.7h2.7v-2.72M10.5 17.5h5.4c-.22 1.4-1.64 4.12-5.4 4.12-3.25 0-5.9-2.7-5.9-6 0-3.33 2.65-6.02 5.9-6.02 1.85 0 3.08.78 3.8 1.46l2.58-2.48c-1.66-1.55-3.8-2.5-6.38-2.5C5.26 6.1 1 10.35 1 15.62s4.26 9.52 9.52 9.52c5.5 0 9.14-3.86 9.14-9.3 0-.62-.07-1.1-.15-1.57h-8.96"/></svg>
        </a>
    </li>
</ul>
<ul class="icon-list">
    <li>
        <a href="/acerca-de">
            <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M7 18.89v-5.88H1.15v-6H7V1.1h6v5.91h6V1.1h6v5.91h5.85v6H25v5.88h5.85v6H25v5.912h-6v-5.91h-6v5.91H7v-5.91H1.15v-6H7zm6 0v-5.88h6v5.88h-6z" fill="#3C8A3F" fill-rule="evenodd"/></svg>
        </a>
    </li>
</ul>
          </div>
      </div>
      <div class="pure-u-1 pure-u-md-6-24">
      </div>
      <div class="pure-u-1 pure-u-md-10-24">
          <div class="footer-content">
              <div class="panel active" id="footer-signup">
    <div class="panel-title">
        <span class="title">Suscríbete</span>
    </div>
    <div class="panel-content">
    Recibe semanalmente lo nuevo en That C# guy
    <form class="pure-form-stacked" action="//thatcsharpguy.us11.list-manage.com/subscribe/post?u=ebfe25f4824d7335380cf1ffd&amp;id=eca72e1174" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
                
                <input type="email" value="" placeholder="dirección de email" name="EMAIL" class="required email" id="mce-EMAIL">
                
                <button type="submit" name="subscribe" id="mc-embedded-subscribe" class="button">
                    <span style="text-decoration:underline;">E</span>nviar
                </button>
                <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true">
                    <input type="text" name="b_ebfe25f4824d7335380cf1ffd_eca72e1174" tabindex="-1" value="">
                </div>
    </form>
    </div>
</div>
          </div>
      </div>
  </div>
</footer>
   
  </body>

</html>
